<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Clément Poupelin">
<meta name="dcterms.date" content="2025-10-14">
<meta name="description" content="This study was made during the Supervised Study Project in Mathematics (SSPM) of the first year of master">

<title>Structural equation modeling and application in psychology (WIP) – Clément Poupelin</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/logo_univ_lille2.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e3b5385bf07e55da6dda6b02310f0c52.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-82eda8b86b26c4b232625dae5d6c37dc.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/logo_univ_lille_gros.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Clément Poupelin</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="./secret_gift.html">
 <span class="dropdown-text">RHU Secret Gift | LilNCog - Bilille</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Open16S.html">
 <span class="dropdown-text">Open16S | MaIAGE - INRAE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./challenge_data.html">
 <span class="dropdown-text">Challenge Data 2023 | OWKIN</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-quarto-blogs-and-reports" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Quarto Blogs and reports</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-quarto-blogs-and-reports">    
        <li>
    <a class="dropdown-item" href="http://clement-poupelin.github.io/Statistique_en_grande_dimension/">
 <span class="dropdown-text">Statistique en grande dimension (M2 WIP)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="http://clement-poupelin.github.io/Series_temporelles/">
 <span class="dropdown-text">Séries temporelles (M2 WIP)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://clement-poupelin.github.io/Regression_lineaire_et_logistique/">
 <span class="dropdown-text">Régression linéaire et logistique (M1 WIP)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./SSPM.html">
 <span class="dropdown-text">Structural equation modeling and application in psychology (WIP)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cv" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">CV</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-cv">    
        <li>
    <a class="dropdown-item" href="./CV/CV_fr.pdf">
 <span class="dropdown-text">French CV</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./CV/CV_en.pdf">
 <span class="dropdown-text">English CV</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="http://github.com/Clement-Poupelin"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://forgemia.inra.fr/clement.poupelin"> <i class="bi bi-gitlab" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://www.linkedin.com/in/cl%C3%A9ment-poupelin-7675311a7/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:clementjc.poupelin@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/clement__poupelin"> <i class="bi bi-instagram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import Data</a></li>
  <li><a href="#preliminary-analysis" id="toc-preliminary-analysis" class="nav-link" data-scroll-target="#preliminary-analysis">Preliminary analysis</a>
  <ul class="collapse">
  <li><a href="#descriptive-analysis" id="toc-descriptive-analysis" class="nav-link" data-scroll-target="#descriptive-analysis">Descriptive analysis</a></li>
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model">Linear Model</a></li>
  <li><a href="#from-linear-models-to-structural-equation-modeling-why-sem-matters" id="toc-from-linear-models-to-structural-equation-modeling-why-sem-matters" class="nav-link" data-scroll-target="#from-linear-models-to-structural-equation-modeling-why-sem-matters">From Linear Models to Structural Equation Modeling: Why SEM Matters</a></li>
  </ul></li>
  <li><a href="#structural-equation-modeling" id="toc-structural-equation-modeling" class="nav-link" data-scroll-target="#structural-equation-modeling">Structural Equation Modeling</a>
  <ul class="collapse">
  <li><a href="#theory" id="toc-theory" class="nav-link" data-scroll-target="#theory">Theory</a></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application">Application</a></li>
  </ul></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation">Validation</a>
  <ul class="collapse">
  <li><a href="#criteria-aic-and-bic" id="toc-criteria-aic-and-bic" class="nav-link" data-scroll-target="#criteria-aic-and-bic">Criteria AIC and BIC</a></li>
  <li><a href="#test-of-nested-models" id="toc-test-of-nested-models" class="nav-link" data-scroll-target="#test-of-nested-models">Test of nested models</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#computational-informations" id="toc-computational-informations" class="nav-link" data-scroll-target="#computational-informations">Computational informations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Structural equation modeling and application in psychology (WIP)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Structural Equation Modeling</div>
    <div class="quarto-category">Psychology</div>
  </div>
  </div>

<div>
  <div class="description">
    This study was made during the Supervised Study Project in Mathematics (SSPM) of the first year of master
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Clément Poupelin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 14, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 28, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<!-- # Intervenant.e.s -->
<!-- ### Rédaction -->
<!-- -   **Clément Poupelin**, [clementjc.poupelin\@gmail.com](mailto:clementjc.poupelin@gmail.com){.email}\ -->
<!-- ### Relecture -->
<!-- -    -->
<!-- ```{r tikz, engine = 'tikz', echo = FALSE, fig.width=6, fig.height=4} -->
<!-- \usetikzlibrary{shapes.geometric, arrows.meta, positioning} -->
<!-- \tikzstyle{decision} = [diamond, draw, fill=white] -->
<!-- \tikzstyle{line} = [draw, -Stealth, thick] -->
<!-- \tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered] -->
<!-- \tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em] -->
<!-- \begin{tikzpicture} %[scale=0.5, transform shape] -->
<!-- % scale=1.2 agrandit tout de 20 %. -->
<!-- % transform shape permet de garder la mise à l’échelle du texte aussi. -->
<!--     % Create Blocks -->
<!--     \node [elli, fill = green!30!white] (compS) {Social comparison}; -->
<!--     \node [elli, fill = magenta!30!white, below of = compS, yshift=-3em, xshift=6em] (selfE) {Self-esteem}; -->
<!--     \node [elli, fill = orange!30!white, below of = compS, yshift=-3em, xshift=-6em] (spirit) {Spirituality}; -->
<!--     % Add Arrows -->
<!--     \path [line] (spirit) -- node[midway, above left] {$\beta = 0.45^{***}$} (compS); -->
<!--     \path [line] (compS) -- node[midway, right] {$\beta = 0.60^{***}$} (selfE); -->
<!--     \path [line] (spirit) -- node[midway, below] {$\beta = 0.25^{*}$} (selfE); -->
<!-- \end{tikzpicture} -->
<!-- ``` -->
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Functions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Seed</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)    <span class="do">## Data manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)    <span class="do">## Data manipulation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="do">## Plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)  <span class="do">## Colorblind palet</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)   <span class="do">## Structural equation modeling</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github('SachaEpskamp/semPlot')</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># library(semPlot)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>create_barplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title, <span class="at">palette =</span> <span class="st">"viridis"</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Item"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Response), <span class="at">fill =</span> <span class="fu">factor</span>(Response))) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> Item, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># 2 colonnes pour le facet</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title, <span class="at">x =</span> <span class="st">"Response"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> palette, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">32</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Personnalisation des titres des facets</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>  <span class="co"># Pas besoin de légende redondante</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">140400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>This tutorial provides a simple application of Structural Equation Modeling (SEM) to introduce the concept using a modified and simplified version of the dataset from the article “<a href="https://dergipark.org.tr/en/download/article-file/2592756">Explicit spirituality, self-esteem and the mechanisms of social and temporal comparison</a>” by Justine Ollivaud, Jean-Michel Galharret, and Nicolas Roussiau.<br>
</p>
<p>The analysis focuses on the psychological research domain, specifically examining the impact of spirituality on self-esteem, mediated by social and temporal comparison mechanisms. The goal is to offer a practical, accessible introduction to SEM for researchers and students interested in psychological data analysis.</p>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">Import Data</h2>
<p>The dataset used in this study is imported in .csv format and we remove all missing values with the <code>na.omit()</code> function.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>SSPM_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Documents/1_Projet/Perso/SSPM_data.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove missing values</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>SSPM_data <span class="ot">&lt;-</span> SSPM_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">47</span>] <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It includes 331 individuals. They are characterized by the 47 following variables :</p>
<ul>
<li><p><code>Identifiant</code> : integer assigned to the individual</p></li>
<li><p><code>spirit1</code>, <span class="math inline">\(\cdots\)</span> , <code>spirit16</code> : answers of the individual for the 16 questions which relate to spirituality</p></li>
<li><p><code>Score_Spirit</code> : total score of the individual for the questions which relate to spirituality</p></li>
<li><p><code>CompSoc1</code>, <span class="math inline">\(\cdots\)</span> , <code>CompSoc8</code> : answers of the individual for the 8 questions which relate to social comparison</p></li>
<li><p><code>Score_CompS</code> : total score of the individual for the questions which relate to social comparison</p></li>
<li><p><code>CompTemp1</code>, <span class="math inline">\(\cdots\)</span> , <code>CompTemp8</code> : answers of the individual for the 8 questions which relate to temporal comparison</p></li>
<li><p><code>Score_CompT</code> : total score of the individual for the questions which relate to temporal comparison</p></li>
<li><p><code>es1</code>, <span class="math inline">\(\cdots\)</span> , <code>es10</code> : answers of the individual for the 10 questions which relate to self esteem</p></li>
<li><p><code>Score_ES</code> : total score of the individual for the questions which relate to self esteem</p></li>
</ul>
<p><!-- - `Sexe` : sexe of the individual --> <!-- - `Age` : age of the individual --> <!-- - `Croy_Rel` : belief or not of the individual to religion --></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>SSPM_data <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5637d78986143fda769c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5637d78986143fda769c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[1,2,3,5,7,8],[3,5,5,5,5,5],[4,5,5,4,4,4],[4,5,5,4,5,4],[5,3,5,3,5,5],[1,5,5,3,5,5],[5,5,5,4,5,4],[4,5,5,4,5,4],[5,5,5,3,5,5],[1,5,4,4,5,4],[5,5,5,3,5,4],[4,5,5,4,4,5],[5,5,5,3,5,5],[1,5,5,4,4,4],[4,5,5,4,4,4],[1,3,5,3,4,5],[5,3,5,5,5,5],[3.5625,4.625,4.9375,3.75,4.6875,4.5],[1,5,4,3,4,4],[1,1,3,1,2,4],[5,1,2,3,4,4],[5,1,2,4,4,4],[1,1,4,2,2,4],[4,5,4,3,4,4],[1,1,3,1,2,4],[4,1,3,1,2,3],[2,2,3.125,2,2,2.875],[1,2,1,1,4,3],[4,4,5,4,3,3],[2,2,1,3,4,4],[2,2,1,3,3,3],[4,2,4,5,4,4],[2,2,3,4,3,4],[4,4,3,1,4,4],[4,4,5,1,4,3],[4.125,3.75,4.375,3,3.125,3],[5,5,4,4,4,4],[5,5,4,4,4,4],[1,1,1,1,1,3],[5,5,5,4,5,4],[1,1,3,3,1,4],[5,5,4,4,5,4],[4,5,3,4,5,4],[1,1,3,5,3,4],[1,1,4,3,1,4],[1,1,4,1,1,3],[4.9,5,3.5,3.7,4.6,3.2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Identifiant<\/th>\n      <th>spirit1<\/th>\n      <th>spirit2<\/th>\n      <th>spirit3<\/th>\n      <th>spirit4<\/th>\n      <th>spirit5<\/th>\n      <th>spirit6<\/th>\n      <th>spirit7<\/th>\n      <th>spirit8<\/th>\n      <th>spirit9<\/th>\n      <th>spirit10<\/th>\n      <th>spirit11<\/th>\n      <th>spirit12<\/th>\n      <th>spirit13<\/th>\n      <th>spirit14<\/th>\n      <th>spirit15<\/th>\n      <th>spirit16<\/th>\n      <th>Score_Spirit<\/th>\n      <th>compSoc1<\/th>\n      <th>compSoc2<\/th>\n      <th>compSoc3<\/th>\n      <th>compSoc4<\/th>\n      <th>compSoc5<\/th>\n      <th>compSoc6<\/th>\n      <th>compSoc7<\/th>\n      <th>compSoc8<\/th>\n      <th>Score_CompS<\/th>\n      <th>compTemp1<\/th>\n      <th>compTemp2<\/th>\n      <th>compTemp3<\/th>\n      <th>compTemp4<\/th>\n      <th>compTemp5<\/th>\n      <th>compTemp6<\/th>\n      <th>compTemp7<\/th>\n      <th>compTemp8<\/th>\n      <th>Score_CompT<\/th>\n      <th>es1<\/th>\n      <th>es2<\/th>\n      <th>es3<\/th>\n      <th>es4<\/th>\n      <th>es5<\/th>\n      <th>es6<\/th>\n      <th>es7<\/th>\n      <th>es8<\/th>\n      <th>es9<\/th>\n      <th>es10<\/th>\n      <th>Score_ES<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Identifiant","targets":1},{"name":"spirit1","targets":2},{"name":"spirit2","targets":3},{"name":"spirit3","targets":4},{"name":"spirit4","targets":5},{"name":"spirit5","targets":6},{"name":"spirit6","targets":7},{"name":"spirit7","targets":8},{"name":"spirit8","targets":9},{"name":"spirit9","targets":10},{"name":"spirit10","targets":11},{"name":"spirit11","targets":12},{"name":"spirit12","targets":13},{"name":"spirit13","targets":14},{"name":"spirit14","targets":15},{"name":"spirit15","targets":16},{"name":"spirit16","targets":17},{"name":"Score_Spirit","targets":18},{"name":"compSoc1","targets":19},{"name":"compSoc2","targets":20},{"name":"compSoc3","targets":21},{"name":"compSoc4","targets":22},{"name":"compSoc5","targets":23},{"name":"compSoc6","targets":24},{"name":"compSoc7","targets":25},{"name":"compSoc8","targets":26},{"name":"Score_CompS","targets":27},{"name":"compTemp1","targets":28},{"name":"compTemp2","targets":29},{"name":"compTemp3","targets":30},{"name":"compTemp4","targets":31},{"name":"compTemp5","targets":32},{"name":"compTemp6","targets":33},{"name":"compTemp7","targets":34},{"name":"compTemp8","targets":35},{"name":"Score_CompT","targets":36},{"name":"es1","targets":37},{"name":"es2","targets":38},{"name":"es3","targets":39},{"name":"es4","targets":40},{"name":"es5","targets":41},{"name":"es6","targets":42},{"name":"es7","targets":43},{"name":"es8","targets":44},{"name":"es9","targets":45},{"name":"es10","targets":46},{"name":"Score_ES","targets":47}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>For this analysis, only positively worded items are retained:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select positively worded items</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>es_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">select =</span> <span class="fu">c</span>(es3, es5, es8, es9, es10)) </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>compSoc_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">select =</span> <span class="fu">c</span>(compSoc1, compSoc3, compSoc4, compSoc6))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>compTemp_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">select =</span> <span class="fu">c</span>(compTemp1, compTemp3, compTemp4, compTemp6))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>spirit_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">select =</span> <span class="fu">c</span>(spirit1, spirit2, spirit3, spirit4, spirit5, spirit6, spirit7, spirit8, spirit9, spirit10, spirit11, spirit12, spirit13, spirit14, spirit15, spirit16))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>es_selected <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "es3"  "es5"  "es8"  "es9"  "es10"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>compSoc_selected <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "compSoc1" "compSoc3" "compSoc4" "compSoc6"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>compTemp_selected <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "compTemp1" "compTemp3" "compTemp4" "compTemp6"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>spirit_selected <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "spirit1"  "spirit2"  "spirit3"  "spirit4"  "spirit5"  "spirit6" 
 [7] "spirit7"  "spirit8"  "spirit9"  "spirit10" "spirit11" "spirit12"
[13] "spirit13" "spirit14" "spirit15" "spirit16"</code></pre>
</div>
</div>
</section>
<section id="preliminary-analysis" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-analysis">Preliminary analysis</h2>
<section id="descriptive-analysis" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-analysis">Descriptive analysis</h3>
<p>To represent the distribution of responses to each questionnaire item, we use barplots. This approach is more intuitive for categorical questionnaire data. We also use facet grids to separate items by construct (e.g., self-esteem, social comparison).<br>
Note that colors can be chosen to be accessible to colorblind individuals.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Self-Esteem</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Spirituality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Social Comparison</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Temporal Comparison</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_barplot</span>(es_selected, <span class="st">"Selected Self-Esteem Items"</span>, <span class="at">palette =</span> <span class="st">"D"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_barplot</span>(spirit_selected, <span class="st">"Spirituality Items"</span>, <span class="at">palette =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_barplot</span>(compSoc_selected, <span class="st">"Selected Social Comparison Items"</span>, <span class="at">palette =</span> <span class="st">"E"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_barplot</span>(compTemp_selected, <span class="st">"Selected Temporal Comparison Items"</span>, <span class="at">palette =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="linear-model" class="level3">
<h3 class="anchored" data-anchor-id="linear-model">Linear Model</h3>
<p>We fit two linear models to explore the relationships between spirituality, social/temporal comparison, and self-esteem:</p>
<ul>
<li><p>Model 1 (M1): Social comparison as a function of spirituality</p></li>
<li><p>Model 2 (M2): Self-esteem as a function of social comparison and spirituality</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Model 2</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear models</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score_CompS <span class="sc">~</span> Score_Spirit, <span class="at">data =</span> SSPM_data)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score_CompS ~ Score_Spirit, data = SSPM_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.60826 -0.49391  0.02527  0.49259  2.16091 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.75886    0.31178  12.056  &lt; 2e-16 ***
Score_Spirit -0.30683    0.06996  -4.386 1.56e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6836 on 329 degrees of freedom
Multiple R-squared:  0.05524,   Adjusted R-squared:  0.05236 
F-statistic: 19.24 on 1 and 329 DF,  p-value: 1.558e-05</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize M1 with added-variable plots</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear models</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score_ES <span class="sc">~</span> Score_CompS <span class="sc">+</span> Score_Spirit, <span class="at">data =</span> SSPM_data)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score_ES ~ Score_CompS + Score_Spirit, data = SSPM_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.1939 -0.3667  0.0061  0.3898  1.4025 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.59609    0.29881  15.381   &lt;2e-16 ***
Score_CompS  -0.46000    0.04401 -10.453   &lt;2e-16 ***
Score_Spirit  0.10314    0.05745   1.795   0.0735 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5456 on 328 degrees of freedom
Multiple R-squared:  0.2813,    Adjusted R-squared:  0.277 
F-statistic:  64.2 on 2 and 328 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize M2 with added-variable plots</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>M1 tests the direct effect of spirituality on social comparison and M2 tests the combined effect of social comparison and spirituality on self-esteem.</p>
<p>Then, the avPlots function helps visualize the contribution of each predictor, adjusting for the others.</p>
</section>
<section id="from-linear-models-to-structural-equation-modeling-why-sem-matters" class="level3">
<h3 class="anchored" data-anchor-id="from-linear-models-to-structural-equation-modeling-why-sem-matters">From Linear Models to Structural Equation Modeling: Why SEM Matters</h3>
<p>In the preliminary analysis, we used linear regression models (lm) to explore the relationships between spirituality, social/temporal comparison, and self-esteem. These models rely on composite scores—that is, the total or average scores derived from summing or averaging responses to multiple questionnaire items (e.g., Score_Spirit, Score_CompS, Score_ES). While this approach is straightforward and easy to interpret, it has several limitations:</p>
<ul>
<li><p><strong>Loss of Nuance</strong>: By aggregating individual items into a single score, we assume that all items contribute equally to the underlying construct (e.g., spirituality or self-esteem). This ignores the possibility that some items may be more relevant or reliable than others, or that the construct itself is multidimensional.</p></li>
<li><p><strong>Measurement Error</strong>: Composite scores are treated as perfectly measured variables, which is rarely true in practice. Measurement error (e.g., due to poorly worded questions or individual differences in interpretation) can bias the estimated relationships between variables.</p></li>
<li><p><strong>Limited Theoretical Flexibility</strong>: Linear regression cannot explicitly model complex theoretical relationships, such as mediation, moderation, or latent variables (unobserved constructs inferred from observed variables).</p></li>
</ul>
<p><strong>Structural Equation Modeling (SEM) addresses these limitations by offering a more sophisticated and theoretically grounded framework for analyzing relationships between variables</strong>.<br>
</p>
</section>
</section>
<section id="structural-equation-modeling" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation-modeling">Structural Equation Modeling</h2>
<section id="theory" class="level3">
<h3 class="anchored" data-anchor-id="theory">Theory</h3>
<p>For a quick understanding, we propose an example of SEM (For more details, do not hesitate to see the dedicated publication <a href="https://github.com/Clement-Poupelin/Clement-Poupelin.github.io/blob/main/docs/SSPM_Aela_JAGOT_Clement_POUPELIN_M1IS.pdf">Structural equation modeling and application in psychology</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>This model can be interpreted as a study aiming to explain the direct effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> and the indirect effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> through <span class="math inline">\(M\)</span>. The latter variable is called the <strong>mediation variable</strong>. In detail, we have:</p>
<ul>
<li><span class="math inline">\(Y\)</span> and <span class="math inline">\(M\)</span> are latent endogenous variables</li>
<li><span class="math inline">\(X\)</span> is a latent exogenous variable</li>
<li><span class="math inline">\(m_i\)</span> are observed endogenous variables, for <span class="math inline">\(i \in \{1, ..., r\}\)</span></li>
<li><span class="math inline">\(x_j\)</span> are observed exogenous variables, for <span class="math inline">\(j \in \{1, ..., s\}\)</span></li>
<li><span class="math inline">\(y_k\)</span> are observed endogenous variables, for <span class="math inline">\(k \in \{1, ..., t\}\)</span></li>
</ul>
<p>We can rewrite the model as a system:</p>
<p><span class="math display">\[
\begin{cases}
\textbf{Measurement model} \\
m_i = \gamma_i M + \xi_{m_i}, \quad \text{for } i \in \{1, ..., r\} \\
x_j = \alpha_j X + \xi_{x_j}, \quad \text{for } j \in \{1, ..., s\} \\
y_k = \beta_k Y + \xi_{y_k}, \quad \text{for } k \in \{1, ..., t\} \\
\\
\textbf{Structural Model} \\
M = b_0 + b_1 X + \mathcal{E}_{M} \\
Y = a_0 + a_1 X + a_2 M + \mathcal{E}_Y
\end{cases}
\]</span></p>
<p>We can also rewrite the structural model in the form of a matrix equation:</p>
<p><span class="math display">\[
\begin{pmatrix}
M \\
Y
\end{pmatrix}
=
\begin{pmatrix}
b_0 \\
a_0
\end{pmatrix}
+
\begin{pmatrix}
b_1 &amp; 0 \\
a_1 &amp; a_2
\end{pmatrix}
\begin{pmatrix}
X \\
M
\end{pmatrix}
+
\begin{pmatrix}
\mathcal{E}_{M} \\
\mathcal{E}_Y
\end{pmatrix}
\]</span></p>
<p>Now, thanks to the way we wrote the model, we can make the different effects explicit. To do this, we take the structural model and substitute the first line into the second line:</p>
<p><span class="math display">\[
\begin{cases}
M = b_0 + b_1 X + \mathcal{E}_{M} \\
Y = a_0 + a_1 X + a_2 M + \mathcal{E}_Y
\end{cases}
\]</span></p>
<p><span class="math inline">\(\Leftrightarrow Y = a_0 + a_1 X + a_2 (b_0 + b_1 X + \mathcal{E}_{M}) + \mathcal{E}_Y\)</span></p>
<p><span class="math inline">\(\Leftrightarrow Y = a_0 + a_2 b_0 + a_1 X + a_2 b_1 X + \mathcal{E}'\)</span></p>
<p><span class="math inline">\(\Leftrightarrow Y = (a_0 + a_2 b_0) + (a_1 + a_2 b_1) X + \mathcal{E}'\)</span></p>
<p>Here, <span class="math inline">\(\quad \mathcal{E}' = a_2 \mathcal{E}_{M} + \mathcal{E}_Y\)</span> with <span class="math inline">\(\mathcal{E}' \in [X]^\bot\)</span> because <span class="math inline">\(\mathcal{E}_M \in [X]^\bot\)</span> and <span class="math inline">\(\mathcal{E}_Y \in [X, M]^\bot\)</span><br>
</p>
<p>Therefore, we can write the effects of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[
\underbrace{\overbrace{a_2 b_1}^{\text{Indirect effect}} + \overbrace{a_1}^{\text{Direct effect}}}_{\text{Total effect}}
\]</span></p>
</section>
<section id="application" class="level3">
<h3 class="anchored" data-anchor-id="application">Application</h3>
<p>We build several model which connects the latent variables <strong>Spirituality, Social comparison, Temporal comparison and Self esteem</strong>.<br>
Each of them being determined by different observed variables.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Programming with <code>lavaan</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Determination of the latent variables</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Model 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Model 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">Model 4</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>The library <code>lavaan</code> on <code>R</code> is usually used to estimate a large variety of multivariate statistical models, like structural equation modeling. For information, this package also permit to estimate path analysis, confirmatory factor analysis and growth curve models.<br>
To programm a structural equation modeling on <code>R</code>, we proceed like this :</p>
<p><span class="math display">\[\begin{align*}
    &amp; \text{Model &lt;- `}\\
    &amp; \quad \# \; \text{latent variables} \\
    &amp; \quad \quad X =\sim x_1 + x_2 + x_3 \\
    &amp; \quad \quad M =\sim m_1 + m_2 + m_3 \\
    &amp; \quad \quad Y =\sim y_1 + y_2 + y_3\\
    &amp; \quad \# \; \text{regressions} \\
    &amp; \quad \quad M \sim X \\
    &amp; \quad \quad Y \sim M + X\\
    &amp; \quad \# \; \text{residual covariances} \\
    &amp; \quad \quad x_1 \sim \sim x_2 \quad \text{`}
\end{align*}\]</span></p>
<p>We can recognize different types of operators :</p>
<ul>
<li><span class="math inline">\(=\sim\)</span> : indicate by which observed variables is measured the latent variable</li>
<li><span class="math inline">\(\sim \;\;\;\)</span> : indicate by which linear regression is estimate the latent variable</li>
<li><span class="math inline">\(\sim\sim\)</span> : indicate the covariance between residuals</li>
</ul>
<p>Then, to fit the model we use the following function :</p>
<p><span class="math display">\[\begin{align*}
fit &lt;- sem(\text{model} = \text{Model}, \text{ data})
\end{align*}\]</span></p>
<p>To make a summary on <code>fit</code> permit to obtain some informations like the AIC criterion and the BIC criterion of the model but also an estimation of the differents coefficients.<br>
</p>
<p>Furthermore, there is also possible to do a SEM on <code>Python</code> with the package <code>semopy</code>. The method used is similar to the one used with <code>lavaan</code> and the estimations are very closed.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Before to model the data frame, it is necessary to determine the four latent variables that will be used in the different models : <strong>Spirituality</strong>, <strong>Social comparison</strong>, <strong>Temporal comparison</strong> and <strong>Self-esteem</strong>.<br>
For the variable <strong>Spirituality</strong>, we preserve all the observed variables of the study. Nevertheless, for <strong>Social comparison</strong>, <strong>Temporal comparison</strong> and <strong>Self-esteem</strong> we only keep the observed variables which have positive coefficients. We can summarize the number of observed variables per latent variables in the following tabular.<br>
</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Latent Variables</strong></th>
<th><strong>Number of Observed Variables</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spirituality</td>
<td>16</td>
</tr>
<tr class="even">
<td>Social comparison</td>
<td>4</td>
</tr>
<tr class="odd">
<td>Temporal comparison</td>
<td>4</td>
</tr>
<tr class="even">
<td>Self-esteem</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><em>Table 2: Number of observed variables per latent variable</em></p>
<p>We can express the measurement model for the latent variables with their corresponding observed variables in the form of equations:</p>
<p><span class="math display">\[
\begin{cases}
\textsf{Spirituality} = \sim \textit{spirit1 + spirit2 + spirit3 + spirit4 + spirit5} \\
\quad \quad \quad \quad \quad \quad \quad + \textit{spirit6 + spirit7 + spirit8 + spirit9 + spirit10} \\
\quad \quad \quad \quad \quad \quad \quad + \textit{spirit11 + spirit12 + spirit13 + spirit14 + spirit15} \\
\quad \quad \quad \quad \quad \quad \quad + \textit{spirit16} \\
\\
\textsf{Social comparison} = \sim \textit{compSoc1 + compSoc3 + compSoc4 + compSoc6} \\
\\
\textsf{Temporal comparison} = \sim \textit{compTemp1 + compTemp3 + compTemp4} \\
\quad \quad \quad \quad \quad \quad \quad \quad \quad + \textit{compTemp6}\\
\\
\textsf{Self-esteem} = \sim \textit{es3 + es5 + es8 + es9 + es10}
\end{cases}
\]</span></p>
<p>Disposing of all our latent variables, it is possible to build different models of structural equations.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc =~ compSoc1 + compSoc3 + compSoc4 + compSoc6</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc ~ 1 + b1 * Spirit</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompSoc</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1 </span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := b1 * a2</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  model1,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The structural equation model</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The dataset containing the variables to be analyzed</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardization of latent variables</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T (TRUE): Latent variables will be standardized (mean=0, standard deviation=1)</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># F (FALSE): Latent variables will not be standardized (default)</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Useful for comparing coefficients across different models or studies</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Method for estimating standard errors</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "boot": Uses bootstrapping to estimate standard errors</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Other possible options: "standard" (default), "robust", etc.</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bootstrapping is useful for small sample sizes or when normality assumptions are not met</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span>  <span class="co"># Number of bootstrap resamples</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 100: Number of bootstrap replications to perform</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Higher numbers provide more precise estimates but increase computation time</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A minimum of 100 is often recommended, but 1000 or more is ideal for stable results</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This parameter is only considered if se="boot"</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>
<code>summary(fit1)</code>
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1, <span class="at">fit =</span> T, <span class="at">rsquare =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-20 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        80

  Number of observations                           331

Model Test User Model:
                                                      
  Test statistic                               789.406
  Degrees of freedom                               270
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4059.958
  Degrees of freedom                               300
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.862
  Tucker-Lewis Index (TLI)                       0.847

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -9203.847
  Loglikelihood unrestricted model (H1)      -8809.144
                                                      
  Akaike (AIC)                               18567.694
  Bayesian (BIC)                             18871.863
  Sample-size adjusted Bayesian (SABIC)      18618.101

Root Mean Square Error of Approximation:

  RMSEA                                          0.076
  90 Percent confidence interval - lower         0.070
  90 Percent confidence interval - upper         0.082
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.161

Standardized Root Mean Square Residual:

  SRMR                                           0.060

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws              100
  Number of successful bootstrap draws             100

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompSoc =~                                          
    compSoc1          0.322    0.084    3.840    0.000
    compSoc3          0.916    0.074   12.364    0.000
    compSoc4          0.865    0.069   12.619    0.000
    compSoc6          0.388    0.074    5.255    0.000
  ES =~                                               
    es3               0.601    0.063    9.523    0.000
    es5               0.712    0.067   10.663    0.000
    es8               0.585    0.066    8.835    0.000
    es9               1.032    0.057   18.210    0.000
    es10              1.024    0.063   16.332    0.000
  Spirit =~                                           
    spirit1           0.334    0.039    8.556    0.000
    spirit2           0.579    0.047   12.388    0.000
    spirit3           0.462    0.041   11.400    0.000
    spirit4           0.425    0.060    7.025    0.000
    spirit5           0.491    0.033   14.766    0.000
    spirit6           0.490    0.041   11.982    0.000
    spirit7           0.598    0.048   12.570    0.000
    spirit8           0.445    0.053    8.463    0.000
    spirit9           0.529    0.045   11.684    0.000
    spirit10          0.563    0.050   11.267    0.000
    spirit11          0.626    0.039   16.083    0.000
    spirit12          0.547    0.045   12.119    0.000
    spirit13          0.519    0.053    9.748    0.000
    spirit14          0.555    0.052   10.608    0.000
    spirit15          0.574    0.052   11.097    0.000
    spirit16          0.508    0.050   10.105    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompSoc ~                                           
    Spirit    (b1)    0.363    0.082    4.444    0.000
  ES ~                                                
    Spirit    (a1)   -0.034    0.061   -0.550    0.582
    CompSoc   (a2)   -0.258    0.086   -3.017    0.003

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .CompSoc           0.000    0.010    0.000    1.000
   .ES                0.000    0.021    0.000    1.000
   .compSoc1          3.341    0.065   51.535    0.000
   .compSoc3          3.677    0.057   64.719    0.000
   .compSoc4          3.677    0.058   63.081    0.000
   .compSoc6          3.782    0.066   56.955    0.000
   .es3               1.755    0.038   45.635    0.000
   .es5               2.006    0.044   45.206    0.000
   .es8               3.369    0.071   47.648    0.000
   .es9               2.438    0.049   49.468    0.000
   .es10              2.178    0.047   46.431    0.000
   .spirit1           4.740    0.031  151.550    0.000
   .spirit2           4.248    0.048   87.605    0.000
   .spirit3           4.607    0.035  131.830    0.000
   .spirit4           4.674    0.037  125.548    0.000
   .spirit5           4.356    0.043  101.477    0.000
   .spirit6           4.438    0.045   99.448    0.000
   .spirit7           4.459    0.044  101.948    0.000
   .spirit8           4.698    0.035  135.047    0.000
   .spirit9           4.447    0.046   96.231    0.000
   .spirit10          4.474    0.039  113.651    0.000
   .spirit11          4.054    0.053   76.776    0.000
   .spirit12          4.495    0.044  102.862    0.000
   .spirit13          4.009    0.050   80.829    0.000
   .spirit14          4.411    0.046   96.643    0.000
   .spirit15          4.260    0.045   94.111    0.000
   .spirit16          4.414    0.044   99.457    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .compSoc1          1.352    0.093   14.569    0.000
   .compSoc3          0.526    0.123    4.262    0.000
   .compSoc4          0.574    0.110    5.242    0.000
   .compSoc6          1.371    0.118   11.654    0.000
   .es3               0.567    0.081    7.023    0.000
   .es5               0.593    0.104    5.688    0.000
   .es8               1.415    0.085   16.654    0.000
   .es9               0.463    0.094    4.944    0.000
   .es10              0.401    0.087    4.623    0.000
   .spirit1           0.189    0.030    6.261    0.000
   .spirit2           0.479    0.068    7.019    0.000
   .spirit3           0.158    0.019    8.355    0.000
   .spirit4           0.245    0.031    7.873    0.000
   .spirit5           0.381    0.054    7.045    0.000
   .spirit6           0.369    0.056    6.621    0.000
   .spirit7           0.283    0.043    6.524    0.000
   .spirit8           0.140    0.018    7.640    0.000
   .spirit9           0.372    0.047    7.858    0.000
   .spirit10          0.253    0.029    8.871    0.000
   .spirit11          0.458    0.042   10.940    0.000
   .spirit12          0.229    0.030    7.637    0.000
   .spirit13          0.803    0.083    9.665    0.000
   .spirit14          0.315    0.036    8.743    0.000
   .spirit15          0.497    0.067    7.476    0.000
   .spirit16          0.378    0.042    9.084    0.000
   .CompSoc           1.000                           
   .ES                1.000                           
    Spirit            1.000                           

R-Square:
                   Estimate
    compSoc1          0.080
    compSoc3          0.644
    compSoc4          0.596
    compSoc6          0.111
    es3               0.408
    es5               0.481
    es8               0.208
    es9               0.714
    es10              0.739
    spirit1           0.371
    spirit2           0.412
    spirit3           0.575
    spirit4           0.425
    spirit5           0.388
    spirit6           0.394
    spirit7           0.559
    spirit8           0.586
    spirit9           0.429
    spirit10          0.556
    spirit11          0.461
    spirit12          0.566
    spirit13          0.251
    spirit14          0.494
    spirit15          0.398
    spirit16          0.405
    CompSoc           0.117
    ES                0.077

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Direct           -0.034    0.061   -0.550    0.582
    Indirect         -0.094    0.038   -2.495    0.013
    Total            -0.128    0.060   -2.133    0.033</code></pre>
</div>
</div>
</details>
<p>The aim is to analyze direct and indirect effects on <strong>Self-esteem</strong> for the model <code>fit1</code>. To reference the first part, we rename our latent variables:</p>
<p><span class="math display">\[
\begin{cases}
X := \textsf{Spirituality} \\
M_1 := \textsf{Social comparison} \\
Y := \textsf{Self-esteem}
\end{cases}
\]</span></p>
<p>This is a <strong>mediation model</strong>. It is possible to analyze the direct and indirect effects on <span class="math inline">\(Y\)</span>.<br>
</p>
<p>First, we make explicit the structural model and substitute in the expression of <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[
\begin{cases}
M_1 = b_0 + b_1 X + \mathcal{E}_{M_1} \\
Y = a_0 + a_1 X + a_2 M_1 + \mathcal{E}_Y
\end{cases}
\]</span></p>
<p><span class="math inline">\(\Leftrightarrow Y = (a_0 + a_2 b_0) + (a_1 + a_2 b_1) X + \mathcal{E}'\)</span></p>
<p>We can verify that the model is identifiable by looking if the <strong>degree of freedom is greater than 0</strong> :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit1 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Degree of fredom for fit1 : 270</code></pre>
</div>
</div>
<p>Finally, with the summary of the fit of the model <code>fit1</code> in <code>R</code>, we can build the following table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Effect</strong></th>
<th><strong>Expression</strong></th>
<th><strong>Estimate</strong></th>
<th><strong>Std.Err</strong></th>
<th><strong>P-value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Direct</td>
<td><span class="math inline">\(a_1\)</span></td>
<td>-0.034</td>
<td>0.061</td>
<td>0.582</td>
</tr>
<tr class="even">
<td>Indirect</td>
<td><span class="math inline">\(a_2 b_1\)</span></td>
<td>-0.094</td>
<td>0.038</td>
<td>0.013</td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(a_1 + a_2 b_1\)</span></td>
<td>-0.128</td>
<td>0.060</td>
<td>0.033</td>
</tr>
</tbody>
</table>
<p><em>Table 3: Effects on <span class="math inline">\(Y\)</span> for the model <code>fit1</code></em></p>
<p>We can conclude that in the model <code>fit1</code>, the <strong>indirect effect is significant for the variable Self-esteem</strong>.</p>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp =~ compTemp1 + compTemp3 + compTemp4 + compTemp6 </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp ~ 1 + b1 * Spirit</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompTemp</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1 </span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := b1 * a2</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  model2,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>
<code>summary(fit2)</code>
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2, <span class="at">fit =</span> T, <span class="at">rsquare =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-20 ended normally after 38 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        80

  Number of observations                           331

Model Test User Model:
                                                      
  Test statistic                               798.679
  Degrees of freedom                               270
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4261.841
  Degrees of freedom                               300
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.867
  Tucker-Lewis Index (TLI)                       0.852

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -9124.922
  Loglikelihood unrestricted model (H1)      -8725.582
                                                      
  Akaike (AIC)                               18409.843
  Bayesian (BIC)                             18714.013
  Sample-size adjusted Bayesian (SABIC)      18460.251

Root Mean Square Error of Approximation:

  RMSEA                                          0.077
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.083
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.209

Standardized Root Mean Square Residual:

  SRMR                                           0.058

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws              100
  Number of successful bootstrap draws             100

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompTemp =~                                         
    compTemp1         0.790    0.064   12.366    0.000
    compTemp3         0.886    0.062   14.260    0.000
    compTemp4         1.042    0.048   21.574    0.000
    compTemp6         0.740    0.078    9.536    0.000
  ES =~                                               
    es3               0.622    0.066    9.424    0.000
    es5               0.737    0.068   10.845    0.000
    es8               0.599    0.069    8.680    0.000
    es9               1.066    0.058   18.327    0.000
    es10              1.055    0.063   16.635    0.000
  Spirit =~                                           
    spirit1           0.335    0.039    8.569    0.000
    spirit2           0.580    0.047   12.450    0.000
    spirit3           0.462    0.041   11.354    0.000
    spirit4           0.425    0.061    7.031    0.000
    spirit5           0.492    0.033   14.767    0.000
    spirit6           0.491    0.041   11.992    0.000
    spirit7           0.599    0.047   12.613    0.000
    spirit8           0.445    0.053    8.459    0.000
    spirit9           0.529    0.045   11.636    0.000
    spirit10          0.562    0.050   11.195    0.000
    spirit11          0.626    0.039   16.080    0.000
    spirit12          0.547    0.045   12.091    0.000
    spirit13          0.519    0.053    9.731    0.000
    spirit14          0.553    0.052   10.546    0.000
    spirit15          0.573    0.052   11.002    0.000
    spirit16          0.505    0.050   10.047    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompTemp ~                                          
    Spirit    (b1)    0.153    0.063    2.437    0.015
  ES ~                                                
    Spirit    (a1)   -0.128    0.058   -2.221    0.026
    CompTemp  (a2)    0.029    0.070    0.413    0.679

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .CompTemp          0.000    0.015    0.000    1.000
   .ES                0.000    0.022    0.000    1.000
   .compTemp1         2.725    0.063   43.112    0.000
   .compTemp3         3.036    0.047   64.128    0.000
   .compTemp4         2.897    0.053   54.381    0.000
   .compTemp6         3.088    0.062   50.146    0.000
   .es3               1.755    0.039   45.502    0.000
   .es5               2.006    0.044   45.126    0.000
   .es8               3.369    0.071   47.553    0.000
   .es9               2.438    0.049   49.278    0.000
   .es10              2.178    0.047   46.288    0.000
   .spirit1           4.740    0.031  151.549    0.000
   .spirit2           4.248    0.048   87.605    0.000
   .spirit3           4.607    0.035  131.831    0.000
   .spirit4           4.674    0.037  125.548    0.000
   .spirit5           4.356    0.043  101.478    0.000
   .spirit6           4.438    0.045   99.448    0.000
   .spirit7           4.459    0.044  101.948    0.000
   .spirit8           4.698    0.035  135.046    0.000
   .spirit9           4.447    0.046   96.231    0.000
   .spirit10          4.474    0.039  113.651    0.000
   .spirit11          4.054    0.053   76.776    0.000
   .spirit12          4.495    0.044  102.863    0.000
   .spirit13          4.009    0.050   80.829    0.000
   .spirit14          4.411    0.046   96.643    0.000
   .spirit15          4.260    0.045   94.111    0.000
   .spirit16          4.414    0.044   99.457    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .compTemp1         1.005    0.115    8.749    0.000
   .compTemp3         0.573    0.092    6.252    0.000
   .compTemp4         0.330    0.071    4.653    0.000
   .compTemp6         1.060    0.121    8.794    0.000
   .es3               0.565    0.083    6.789    0.000
   .es5               0.589    0.108    5.470    0.000
   .es8               1.421    0.085   16.653    0.000
   .es9               0.462    0.099    4.653    0.000
   .es10              0.405    0.093    4.344    0.000
   .spirit1           0.189    0.030    6.216    0.000
   .spirit2           0.479    0.068    7.044    0.000
   .spirit3           0.158    0.019    8.368    0.000
   .spirit4           0.244    0.031    7.819    0.000
   .spirit5           0.380    0.054    7.064    0.000
   .spirit6           0.368    0.056    6.621    0.000
   .spirit7           0.282    0.043    6.567    0.000
   .spirit8           0.139    0.018    7.639    0.000
   .spirit9           0.373    0.047    7.910    0.000
   .spirit10          0.254    0.029    8.878    0.000
   .spirit11          0.457    0.042   10.965    0.000
   .spirit12          0.229    0.030    7.645    0.000
   .spirit13          0.803    0.083    9.649    0.000
   .spirit14          0.317    0.036    8.711    0.000
   .spirit15          0.499    0.067    7.461    0.000
   .spirit16          0.380    0.042    9.126    0.000
   .CompTemp          1.000                           
   .ES                1.000                           
    Spirit            1.000                           

R-Square:
                   Estimate
    compTemp1         0.388
    compTemp3         0.584
    compTemp4         0.771
    compTemp6         0.346
    es3               0.411
    es5               0.484
    es8               0.204
    es9               0.714
    es10              0.736
    spirit1           0.374
    spirit2           0.412
    spirit3           0.575
    spirit4           0.425
    spirit5           0.389
    spirit6           0.396
    spirit7           0.559
    spirit8           0.588
    spirit9           0.428
    spirit10          0.554
    spirit11          0.462
    spirit12          0.566
    spirit13          0.251
    spirit14          0.491
    spirit15          0.396
    spirit16          0.402
    CompTemp          0.023
    ES                0.016

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Direct           -0.128    0.058   -2.221    0.026
    Indirect          0.004    0.012    0.354    0.723
    Total            -0.124    0.057   -2.164    0.030</code></pre>
</div>
</div>
</details>
<p>The aim is to analyze direct and indirect effects on <strong>Self-esteem</strong> for the model <code>fit2</code>. To reference the first part, we rename our latent variables:</p>
<p><span class="math display">\[
\begin{cases}
X := \textsf{Spirituality} \\
M_2 := \textsf{Temporal comparison} \\
Y := \textsf{Self-esteem}
\end{cases}
\]</span></p>
<p>This is still a <strong>mediation model</strong>. It is possible to analyze the direct and indirect effects on <span class="math inline">\(Y\)</span>.<br>
</p>
<p>First, we make explicit the structural model and substitute in the expression of <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[
\begin{cases}
M_2 = b_0 + b_1 X + \mathcal{E}_{M_2} \\
Y = a_0 + a_1 X + a_2 M_2 + \mathcal{E}_Y
\end{cases}
\]</span></p>
<p><span class="math inline">\(\Leftrightarrow Y = (a_0 + a_2 b_0) + (a_1 + a_2 b_1) X + \mathcal{E}'\)</span></p>
<p>We can verify that the model is identifiable by looking if the <strong>degree of freedom is greater than 0</strong> :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit2 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Degree of fredom for fit2 : 245</code></pre>
</div>
</div>
<p>Finally, with the summary of the fit of the model <code>fit2</code> in <code>R</code>, we can build the following table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Effect</strong></th>
<th><strong>Expression</strong></th>
<th><strong>Estimate</strong></th>
<th><strong>Std.Err</strong></th>
<th><strong>P-value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Direct</td>
<td><span class="math inline">\(a_1\)</span></td>
<td>-0.128</td>
<td>0.058</td>
<td>0.026</td>
</tr>
<tr class="even">
<td>Indirect</td>
<td><span class="math inline">\(a_2 b_1\)</span></td>
<td>0.004</td>
<td>0.012</td>
<td>0.723</td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(a_1 + a_2 b_1\)</span></td>
<td>-0.124</td>
<td>0.057</td>
<td>0.030</td>
</tr>
</tbody>
</table>
<p><em>Table ?????,: Effects on <span class="math inline">\(Y\)</span> for the model <code>fit2</code></em></p>
<p>We can conclude that in the model <code>fit2</code>, the <strong>direct effect is significant for the variable Self-esteem</strong>.</p>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc =~ compSoc1 + compSoc3 + compSoc4 + compSoc6</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp =~ compTemp1 + compTemp3 + compTemp4 + compTemp6</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc ~ 1 + c1 * Spirit</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp ~ 1 + b1 * Spirit</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompSoc + a3 * CompTemp</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect1 := (c1 * a2) </span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect2 := (b1 * a3)</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := (c1 * a2) + (b1 * a3)</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  model3,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>
<code>summary(fit3)</code>
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3, <span class="at">fit =</span> T, <span class="at">rsquare =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-20 ended normally after 39 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        95

  Number of observations                           331

Model Test User Model:
                                                      
  Test statistic                              1006.804
  Degrees of freedom                               369
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4728.539
  Degrees of freedom                               406
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.852
  Tucker-Lewis Index (TLI)                       0.838

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11132.232
  Loglikelihood unrestricted model (H1)     -10628.830
                                                      
  Akaike (AIC)                               22454.464
  Bayesian (BIC)                             22815.665
  Sample-size adjusted Bayesian (SABIC)      22514.322

Root Mean Square Error of Approximation:

  RMSEA                                          0.072
  90 Percent confidence interval - lower         0.067
  90 Percent confidence interval - upper         0.078
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.009

Standardized Root Mean Square Residual:

  SRMR                                           0.070

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws              100
  Number of successful bootstrap draws             100

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompSoc =~                                          
    compSoc1          0.322    0.084    3.853    0.000
    compSoc3          0.917    0.074   12.426    0.000
    compSoc4          0.861    0.069   12.482    0.000
    compSoc6          0.388    0.074    5.241    0.000
  CompTemp =~                                         
    compTemp1         0.794    0.064   12.418    0.000
    compTemp3         0.887    0.061   14.516    0.000
    compTemp4         1.034    0.049   21.260    0.000
    compTemp6         0.740    0.077    9.613    0.000
  ES =~                                               
    es3               0.597    0.062    9.663    0.000
    es5               0.706    0.065   10.824    0.000
    es8               0.580    0.065    8.975    0.000
    es9               1.018    0.063   16.116    0.000
    es10              1.008    0.069   14.658    0.000
  Spirit =~                                           
    spirit1           0.334    0.039    8.556    0.000
    spirit2           0.579    0.047   12.384    0.000
    spirit3           0.462    0.041   11.384    0.000
    spirit4           0.425    0.060    7.021    0.000
    spirit5           0.492    0.033   14.777    0.000
    spirit6           0.490    0.041   12.006    0.000
    spirit7           0.598    0.048   12.511    0.000
    spirit8           0.444    0.053    8.442    0.000
    spirit9           0.530    0.045   11.695    0.000
    spirit10          0.563    0.050   11.270    0.000
    spirit11          0.626    0.039   16.087    0.000
    spirit12          0.546    0.045   12.107    0.000
    spirit13          0.519    0.053    9.748    0.000
    spirit14          0.554    0.052   10.584    0.000
    spirit15          0.575    0.052   11.123    0.000
    spirit16          0.507    0.050   10.089    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompSoc ~                                           
    Spirit    (c1)    0.369    0.083    4.427    0.000
  CompTemp ~                                          
    Spirit    (b1)    0.164    0.064    2.543    0.011
  ES ~                                                
    Spirit    (a1)   -0.036    0.062   -0.582    0.561
    CompSoc   (a2)   -0.315    0.102   -3.101    0.002
    CompTemp  (a3)    0.141    0.083    1.685    0.092

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .CompSoc           0.000    0.011    0.000    1.000
   .CompTemp          0.000    0.015    0.000    1.000
   .ES                0.000    0.021    0.000    1.000
   .compSoc1          3.341    0.065   51.567    0.000
   .compSoc3          3.677    0.057   64.948    0.000
   .compSoc4          3.677    0.058   63.252    0.000
   .compSoc6          3.782    0.066   56.981    0.000
   .compTemp1         2.725    0.063   43.184    0.000
   .compTemp3         3.036    0.048   63.882    0.000
   .compTemp4         2.897    0.054   53.961    0.000
   .compTemp6         3.088    0.062   50.090    0.000
   .es3               1.755    0.038   45.855    0.000
   .es5               2.006    0.044   45.476    0.000
   .es8               3.369    0.071   47.662    0.000
   .es9               2.438    0.049   49.382    0.000
   .es10              2.178    0.047   46.383    0.000
   .spirit1           4.740    0.031  151.549    0.000
   .spirit2           4.248    0.048   87.605    0.000
   .spirit3           4.607    0.035  131.830    0.000
   .spirit4           4.674    0.037  125.549    0.000
   .spirit5           4.356    0.043  101.478    0.000
   .spirit6           4.438    0.045   99.449    0.000
   .spirit7           4.459    0.044  101.948    0.000
   .spirit8           4.698    0.035  135.047    0.000
   .spirit9           4.447    0.046   96.231    0.000
   .spirit10          4.474    0.039  113.651    0.000
   .spirit11          4.054    0.053   76.776    0.000
   .spirit12          4.495    0.044  102.863    0.000
   .spirit13          4.009    0.050   80.829    0.000
   .spirit14          4.411    0.046   96.643    0.000
   .spirit15          4.260    0.045   94.111    0.000
   .spirit16          4.414    0.044   99.458    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .compSoc1          1.352    0.093   14.570    0.000
   .compSoc3          0.521    0.123    4.243    0.000
   .compSoc4          0.579    0.110    5.274    0.000
   .compSoc6          1.371    0.118   11.646    0.000
   .compTemp1         0.996    0.116    8.624    0.000
   .compTemp3         0.568    0.090    6.342    0.000
   .compTemp4         0.342    0.070    4.857    0.000
   .compTemp6         1.058    0.120    8.796    0.000
   .es3               0.562    0.082    6.825    0.000
   .es5               0.588    0.106    5.565    0.000
   .es8               1.412    0.084   16.731    0.000
   .es9               0.467    0.098    4.783    0.000
   .es10              0.408    0.091    4.498    0.000
   .spirit1           0.189    0.030    6.273    0.000
   .spirit2           0.479    0.068    7.016    0.000
   .spirit3           0.158    0.019    8.332    0.000
   .spirit4           0.245    0.031    7.892    0.000
   .spirit5           0.380    0.054    7.051    0.000
   .spirit6           0.369    0.056    6.619    0.000
   .spirit7           0.284    0.043    6.523    0.000
   .spirit8           0.140    0.018    7.651    0.000
   .spirit9           0.371    0.047    7.900    0.000
   .spirit10          0.253    0.028    8.882    0.000
   .spirit11          0.457    0.042   10.963    0.000
   .spirit12          0.229    0.030    7.638    0.000
   .spirit13          0.803    0.083    9.658    0.000
   .spirit14          0.316    0.036    8.755    0.000
   .spirit15          0.497    0.067    7.462    0.000
   .spirit16          0.378    0.042    9.097    0.000
   .CompSoc           1.000                           
   .CompTemp          1.000                           
   .ES                1.000                           
    Spirit            1.000                           

R-Square:
                   Estimate
    compSoc1          0.080
    compSoc3          0.647
    compSoc4          0.592
    compSoc6          0.111
    compTemp1         0.394
    compTemp3         0.587
    compTemp4         0.763
    compTemp6         0.347
    es3               0.419
    es5               0.491
    es8               0.213
    es9               0.716
    es10              0.739
    spirit1           0.371
    spirit2           0.412
    spirit3           0.574
    spirit4           0.424
    spirit5           0.389
    spirit6           0.394
    spirit7           0.558
    spirit8           0.584
    spirit9           0.431
    spirit10          0.556
    spirit11          0.461
    spirit12          0.565
    spirit13          0.251
    spirit14          0.493
    spirit15          0.399
    spirit16          0.405
    CompSoc           0.120
    CompTemp          0.026
    ES                0.120

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Direct           -0.036    0.062   -0.582    0.561
    Indirect1        -0.116    0.047   -2.478    0.013
    Indirect2         0.023    0.019    1.188    0.235
    Indirect         -0.093    0.038   -2.462    0.014
    Total            -0.129    0.061   -2.124    0.034</code></pre>
</div>
</div>
</details>
<p>The aim is to analyse direct and indirect effects on <strong>Self-esteem</strong> for the model <code>fit3</code>. To reference to the first part, we rename our latent variables as we already have done for <code>fit1</code> and <code>fit2</code> :</p>
<p><span class="math display">\[
\begin{cases}
X := \textsf{Spirituality} \\
M_1 := \textsf{Social comparison} \\
M_2 := \textsf{Temporal comparison} \\
Y := \textsf{Self-esteem}
\end{cases}
\]</span></p>
<p>This is a <strong>parallel mediation model</strong>. It is possible to analyse the direct and indirect effects on <span class="math inline">\(Y\)</span>. Before that, we explicit the structural model and we substitute in the expression of <span class="math inline">\(Y\)</span>.</p>
<p><span class="math display">\[
\begin{cases}
M_1 = c_0 + c_1X + \mathcal{E}_{M_1}\\
M_2 = b_0 + b_1 X + \mathcal{E}_{M_2} \\
Y = a_0 + a_1 X + a_2 M_1 + a_3M_2 + \mathcal{E}_Y
\end{cases}
\]</span> <span class="math display">\[\Leftrightarrow Y = (a_0 + a_2c_0 + a_3b_0) + (a_1 + a_2c_1 + a_3b_1)X + \mathcal{E}'\]</span> We can verify that the model is identifiable by looking if the <strong>degree of freedom is greater than 0</strong> :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit3 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Degree of fredom for fit3 : 369</code></pre>
</div>
</div>
<p>Finally, with the summary of the fit of the model <code>fit3</code> in <code>R</code>, we can build the following table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 32%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Effect</strong></th>
<th><strong>Expression</strong></th>
<th><strong>Estimate</strong></th>
<th><strong>Std.Err</strong></th>
<th><strong>P-value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Direct</td>
<td><span class="math inline">\(a_1\)</span></td>
<td>-0.036</td>
<td>0.062</td>
<td>0.561</td>
</tr>
<tr class="even">
<td>Indirect1</td>
<td><span class="math inline">\(a_2 c_1\)</span></td>
<td>-0.116</td>
<td>0.047</td>
<td>0.013</td>
</tr>
<tr class="odd">
<td>Indirect2</td>
<td><span class="math inline">\(a_3 b_1\)</span></td>
<td>0.023</td>
<td>0.019</td>
<td>0.235</td>
</tr>
<tr class="even">
<td>Indirect</td>
<td><span class="math inline">\(a_2 c_1 + a_3 b_1\)</span></td>
<td>-0.093</td>
<td>0.038</td>
<td>0.014</td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(a_1 + a_2 c_1 + a_3 b_1\)</span></td>
<td>-0.129</td>
<td>0.061</td>
<td>0.034</td>
</tr>
</tbody>
</table>
<p><em>Table ?????,: Effects on <span class="math inline">\(Y\)</span> for the model <code>fit3</code></em></p>
<p>We can conclude that in the model <code>fit3</code>, the <strong>indirect effect is significant for the variable Self-esteem</strong>.<br>
Especially, the most significant effect is given by the path :<br>
<strong>Spirituality <span class="math inline">\(\rightarrow\)</span> Social comparison <span class="math inline">\(\rightarrow\)</span> Self-esteem</strong>.</p>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SSPM_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc =~ compSoc1 + compSoc3 + compSoc4 + compSoc6</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp =~ compTemp1 + compTemp3 + compTemp4 + compTemp6</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc ~ 1 + c1 * Spirit</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp ~ 1 + b1 * Spirit + b2 * CompSoc</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompSoc + a3 * CompTemp</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect1 := (c1 * a2) </span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect2 := (b1 * a3)</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect3 := (c1 * b2 * a3)</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := (c1 * a2) + (b1 * a3) + (c1 * b2 * a3)</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  model4,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>
<code>summary(fit4)</code>
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4, <span class="at">fit =</span> T, <span class="at">rsquare =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-20 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        96

  Number of observations                           331

Model Test User Model:
                                                      
  Test statistic                               958.542
  Degrees of freedom                               368
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4728.539
  Degrees of freedom                               406
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.863
  Tucker-Lewis Index (TLI)                       0.849

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -11108.101
  Loglikelihood unrestricted model (H1)     -10628.830
                                                      
  Akaike (AIC)                               22408.201
  Bayesian (BIC)                             22773.205
  Sample-size adjusted Bayesian (SABIC)      22468.690

Root Mean Square Error of Approximation:

  RMSEA                                          0.070
  90 Percent confidence interval - lower         0.064
  90 Percent confidence interval - upper         0.075
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.001

Standardized Root Mean Square Residual:

  SRMR                                           0.059

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws              100
  Number of successful bootstrap draws             100

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompSoc =~                                          
    compSoc1          0.339    0.084    4.021    0.000
    compSoc3          0.933    0.073   12.859    0.000
    compSoc4          0.844    0.065   12.933    0.000
    compSoc6          0.383    0.074    5.180    0.000
  CompTemp =~                                         
    compTemp1         0.711    0.065   11.000    0.000
    compTemp3         0.802    0.060   13.370    0.000
    compTemp4         0.891    0.057   15.662    0.000
    compTemp6         0.657    0.066   10.009    0.000
  ES =~                                               
    es3               0.595    0.061    9.685    0.000
    es5               0.704    0.065   10.812    0.000
    es8               0.578    0.064    8.964    0.000
    es9               1.015    0.064   15.832    0.000
    es10              1.005    0.070   14.429    0.000
  Spirit =~                                           
    spirit1           0.334    0.039    8.555    0.000
    spirit2           0.579    0.047   12.392    0.000
    spirit3           0.462    0.041   11.389    0.000
    spirit4           0.425    0.060    7.024    0.000
    spirit5           0.492    0.033   14.769    0.000
    spirit6           0.490    0.041   11.992    0.000
    spirit7           0.598    0.048   12.552    0.000
    spirit8           0.445    0.053    8.456    0.000
    spirit9           0.529    0.045   11.677    0.000
    spirit10          0.563    0.050   11.262    0.000
    spirit11          0.626    0.039   16.087    0.000
    spirit12          0.547    0.045   12.119    0.000
    spirit13          0.519    0.053    9.749    0.000
    spirit14          0.554    0.052   10.593    0.000
    spirit15          0.574    0.052   11.097    0.000
    spirit16          0.507    0.050   10.094    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  CompSoc ~                                           
    Spirit    (c1)    0.364    0.082    4.450    0.000
  CompTemp ~                                          
    Spirit    (b1)   -0.011    0.062   -0.173    0.862
    CompSoc   (b2)    0.529    0.102    5.163    0.000
  ES ~                                                
    Spirit    (a1)   -0.033    0.063   -0.518    0.604
    CompSoc   (a2)   -0.356    0.118   -3.024    0.002
    CompTemp  (a3)    0.177    0.087    2.030    0.042

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .CompSoc           0.000    0.014    0.000    1.000
   .CompTemp          0.000    0.014    0.000    1.000
   .ES                0.000    0.021    0.000    1.000
   .compSoc1          3.341    0.064   52.388    0.000
   .compSoc3          3.677    0.055   67.427    0.000
   .compSoc4          3.677    0.058   63.882    0.000
   .compSoc6          3.782    0.066   56.999    0.000
   .compTemp1         2.725    0.062   43.710    0.000
   .compTemp3         3.036    0.047   65.250    0.000
   .compTemp4         2.897    0.054   53.876    0.000
   .compTemp6         3.088    0.061   50.578    0.000
   .es3               1.755    0.038   45.765    0.000
   .es5               2.006    0.044   45.281    0.000
   .es8               3.369    0.071   47.635    0.000
   .es9               2.438    0.049   49.278    0.000
   .es10              2.178    0.047   46.226    0.000
   .spirit1           4.740    0.031  151.550    0.000
   .spirit2           4.248    0.048   87.605    0.000
   .spirit3           4.607    0.035  131.830    0.000
   .spirit4           4.674    0.037  125.547    0.000
   .spirit5           4.356    0.043  101.477    0.000
   .spirit6           4.438    0.045   99.448    0.000
   .spirit7           4.459    0.044  101.948    0.000
   .spirit8           4.698    0.035  135.047    0.000
   .spirit9           4.447    0.046   96.231    0.000
   .spirit10          4.474    0.039  113.651    0.000
   .spirit11          4.054    0.053   76.776    0.000
   .spirit12          4.495    0.044  102.863    0.000
   .spirit13          4.009    0.050   80.829    0.000
   .spirit14          4.411    0.046   96.643    0.000
   .spirit15          4.260    0.045   94.111    0.000
   .spirit16          4.414    0.044   99.457    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .compSoc1          1.340    0.094   14.194    0.000
   .compSoc3          0.490    0.118    4.168    0.000
   .compSoc4          0.614    0.101    6.062    0.000
   .compSoc6          1.376    0.116   11.884    0.000
   .compTemp1         0.981    0.113    8.643    0.000
   .compTemp3         0.532    0.085    6.275    0.000
   .compTemp4         0.397    0.069    5.785    0.000
   .compTemp6         1.054    0.120    8.803    0.000
   .es3               0.562    0.082    6.823    0.000
   .es5               0.588    0.106    5.560    0.000
   .es8               1.412    0.084   16.729    0.000
   .es9               0.467    0.098    4.783    0.000
   .es10              0.408    0.091    4.499    0.000
   .spirit1           0.189    0.030    6.260    0.000
   .spirit2           0.479    0.068    7.022    0.000
   .spirit3           0.158    0.019    8.340    0.000
   .spirit4           0.245    0.031    7.875    0.000
   .spirit5           0.380    0.054    7.054    0.000
   .spirit6           0.369    0.056    6.621    0.000
   .spirit7           0.283    0.043    6.522    0.000
   .spirit8           0.140    0.018    7.641    0.000
   .spirit9           0.372    0.047    7.881    0.000
   .spirit10          0.253    0.028    8.876    0.000
   .spirit11          0.457    0.042   10.954    0.000
   .spirit12          0.229    0.030    7.640    0.000
   .spirit13          0.803    0.083    9.663    0.000
   .spirit14          0.315    0.036    8.738    0.000
   .spirit15          0.497    0.067    7.470    0.000
   .spirit16          0.378    0.042    9.093    0.000
   .CompSoc           1.000                           
   .CompTemp          1.000                           
   .ES                1.000                           
    Spirit            1.000                           

R-Square:
                   Estimate
    compSoc1          0.088
    compSoc3          0.668
    compSoc4          0.568
    compSoc6          0.108
    compTemp1         0.403
    compTemp3         0.614
    compTemp4         0.724
    compTemp6         0.350
    es3               0.413
    es5               0.485
    es8               0.209
    es9               0.711
    es10              0.734
    spirit1           0.371
    spirit2           0.412
    spirit3           0.575
    spirit4           0.425
    spirit5           0.388
    spirit6           0.394
    spirit7           0.559
    spirit8           0.585
    spirit9           0.429
    spirit10          0.556
    spirit11          0.461
    spirit12          0.566
    spirit13          0.251
    spirit14          0.494
    spirit15          0.398
    spirit16          0.405
    CompSoc           0.117
    CompTemp          0.238
    ES                0.105

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    Direct           -0.033    0.063   -0.518    0.604
    Indirect1        -0.129    0.053   -2.458    0.014
    Indirect2        -0.002    0.013   -0.150    0.880
    Indirect3         0.034    0.021    1.606    0.108
    Indirect         -0.097    0.039   -2.461    0.014
    Total            -0.130    0.061   -2.125    0.034</code></pre>
</div>
</div>
</details>
<p>The aim is to analyse direct and indirect effects on <strong>Self-esteem</strong> for the model <code>fit4</code>. To reference to the first part, we rename our latent variables as we already have done for <code>fit1</code> and <code>fit2</code> :</p>
<p><span class="math display">\[
\begin{cases}
X := \textsf{Spirituality} \\
M_1 := \textsf{Social comparison} \\
M_2 := \textsf{Temporal comparison} \\
Y := \textsf{Self-esteem}
\end{cases}
\]</span></p>
<p>This is a <strong>serial mediation model</strong>. It is possible to analyse the direct and indirect effects on <span class="math inline">\(Y\)</span>. Before that, we explicit the structural model and we substitute in the expression of <span class="math inline">\(Y\)</span>.</p>
<p><span class="math display">\[
\begin{cases}
M_1 = c_0 + c_1X + \mathcal{E}_{M_1}\\
M_2 = b_0 + b_1 X + b_2 M_2 + \mathcal{E}_{M_2} \\
Y = a_0 + a_1 X + a_2 M_1 + a_3M_2 + \mathcal{E}_Y
\end{cases}
\]</span> <span class="math display">\[\Leftrightarrow Y = (a_0 + a_2c_0 + a_3b_0 + a_3b_2c_0) + (a_1 + a_2c_1 + a_3b_1 + a_3b_2c_1)X + \mathcal{E}'\]</span> We can verify that the model is identifiable by looking if the <strong>degree of freedom is greater than 0</strong> :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit4 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Degree of fredom for fit4 : 368</code></pre>
</div>
</div>
<p>Finally, with the summary of the fit of the model <code>fi43</code> in <code>R</code>, we can build the following table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 40%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Effect</strong></th>
<th><strong>Expression</strong></th>
<th><strong>Estimate</strong></th>
<th><strong>Std.Err</strong></th>
<th><strong>P-value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Direct</td>
<td><span class="math inline">\(a_1\)</span></td>
<td>-0.033</td>
<td>0.063</td>
<td>0.604</td>
</tr>
<tr class="even">
<td>Indirect1</td>
<td><span class="math inline">\(a_2 c_1\)</span></td>
<td>-0.129</td>
<td>0.053</td>
<td>0.014</td>
</tr>
<tr class="odd">
<td>Indirect2</td>
<td><span class="math inline">\(a_3 b_1\)</span></td>
<td>-0.002</td>
<td>0.013</td>
<td>0.880</td>
</tr>
<tr class="even">
<td>Indirect3</td>
<td><span class="math inline">\(a_3b_2c_1\)</span></td>
<td>0.034</td>
<td>0.021</td>
<td>0.108</td>
</tr>
<tr class="odd">
<td>Indirect</td>
<td><span class="math inline">\(a_2 c_1 + a_3 b_1 + a_3b_2c_1\)</span></td>
<td>-0.097</td>
<td>0.039</td>
<td>0.014</td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(a_1 + a_2c_1 + a_3b_1 + a_3b_2c_1\)</span></td>
<td>-0.130</td>
<td>0.061</td>
<td>0.034</td>
</tr>
</tbody>
</table>
<p><em>Table ?????,: Effects on <span class="math inline">\(Y\)</span> for the model <code>fit4</code></em></p>
<p>We can conclude that in the model <code>fit4</code>, the <strong>indirect effect is significant for the variable Self-esteem</strong>.<br>
Especially, the most significant effect is given by the path :<br>
<strong>Spirituality <span class="math inline">\(\rightarrow\)</span> Social comparison <span class="math inline">\(\rightarrow\)</span> Self-esteem</strong> (same as <code>fit3</code>).</p>
</div>
</div>
</div>
</section>
</section>
<section id="validation" class="level2">
<h2 class="anchored" data-anchor-id="validation">Validation</h2>
<p>In this part, the objective will be to compare all the models we built to determine which one is the best for the study.</p>
<section id="criteria-aic-and-bic" class="level3">
<h3 class="anchored" data-anchor-id="criteria-aic-and-bic">Criteria AIC and BIC</h3>
At first, the aim will be to compare models with the same size, that means with and with . To do that we use the criteria of AIC and BIC. All the values are given in the summaries of the different .\
<p>In both cases, the best model is the model which minimize the criterion AIC and the criterion BIC. We retain the models and .</p>
</section>
<section id="test-of-nested-models" class="level3">
<h3 class="anchored" data-anchor-id="test-of-nested-models">Test of nested models</h3>
<p>Now stay available two models which are and . To decide between them, we realize a test of nested models using the function on .\</p>
<p>The Chi-Squared Difference Test give a p-value of 0,000104. \ The test indicates that it is preferable to keep the additional variable of the model .\</p>
<p>We can conclude that the model is the best model for the study.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>The aim of the study was to understand the connections between spirituality, social comparison, temporal comparison and self-esteem for individuals. Especially, we wanted to analyze the effects of spirituality on self-esteem and determine if they pass through social comparison and/or temporal comparison.<br>
</p>
<p>Thanks to criteria and tests we used, we were able to define the best model for this study : .<br>
It gather all the notions and take into account an influence of social comparison on temporal comparison. According to this model which highlights the significance of the indirect effect , the main effect on self-esteem of individuals is social comparison due to spirituality.<br>
</p>
<p>To put it in a nutshell, we can conclude in favor of connection between the different notions. Especially, the effect of spirituality on self-esteem transits by social comparison.</p>
</section>
<section id="computational-informations" class="level2">
<h2 class="anchored" data-anchor-id="computational-informations">Computational informations</h2>
<details>
<summary>
Session informations
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.2 (2024-10-31)
 os       Ubuntu 24.04.1 LTS
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  fr_FR.UTF-8
 ctype    fr_FR.UTF-8
 tz       Europe/Paris
 date     2025-10-28
 pandoc   3.2 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/x86_64/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version    date (UTC) lib source
 abind          1.4-8      2024-09-12 [1] CRAN (R 4.4.2)
 askpass        1.2.1      2024-10-04 [2] CRAN (R 4.3.3)
 bslib          0.9.0      2025-01-30 [1] CRAN (R 4.4.2)
 cachem         1.1.0      2024-05-16 [2] CRAN (R 4.3.3)
 car            3.1-3      2024-09-27 [1] CRAN (R 4.4.2)
 carData        3.0-5      2022-01-06 [1] CRAN (R 4.4.2)
 cli            3.6.5      2025-04-23 [1] CRAN (R 4.4.2)
 crosstalk      1.2.1      2023-11-23 [1] CRAN (R 4.4.2)
 devtools       2.4.5      2022-10-11 [1] CRAN (R 4.4.2)
 digest         0.6.37     2024-08-19 [1] CRAN (R 4.4.2)
 dplyr        * 1.1.4      2023-11-17 [1] CRAN (R 4.4.2)
 DT             0.33       2024-04-04 [1] CRAN (R 4.4.2)
 ellipsis       0.3.2      2021-04-29 [2] CRAN (R 4.3.3)
 evaluate       1.0.5      2025-08-27 [1] CRAN (R 4.4.2)
 farver         2.1.2      2024-05-13 [1] CRAN (R 4.4.2)
 fastmap        1.2.0      2024-05-15 [2] CRAN (R 4.3.3)
 Formula        1.2-5      2023-02-24 [1] CRAN (R 4.4.2)
 fs             1.6.6      2025-04-12 [1] CRAN (R 4.4.2)
 generics       0.1.3      2022-07-05 [1] CRAN (R 4.4.2)
 ggplot2      * 4.0.0      2025-09-11 [1] CRAN (R 4.4.2)
 glue           1.8.0      2024-09-30 [2] CRAN (R 4.3.3)
 gridExtra      2.3        2017-09-09 [1] CRAN (R 4.4.2)
 gtable         0.3.6      2024-10-25 [1] CRAN (R 4.4.2)
 htmltools      0.5.8.1    2024-04-04 [2] CRAN (R 4.3.3)
 htmlwidgets    1.6.4      2023-12-06 [2] CRAN (R 4.3.3)
 httpuv         1.6.15     2024-03-26 [2] CRAN (R 4.3.3)
 jquerylib      0.1.4      2021-04-26 [2] CRAN (R 4.3.3)
 jsonlite       2.0.0      2025-03-27 [1] CRAN (R 4.4.2)
 knitr          1.50       2025-03-16 [1] CRAN (R 4.4.2)
 labeling       0.4.3      2023-08-29 [1] CRAN (R 4.4.2)
 later          1.4.1      2024-11-27 [2] CRAN (R 4.3.3)
 lavaan       * 0.6-20     2025-09-21 [1] CRAN (R 4.4.2)
 lifecycle      1.0.4      2023-11-07 [2] CRAN (R 4.3.3)
 magick         2.9.0      2025-09-08 [1] CRAN (R 4.4.2)
 magrittr       2.0.4      2025-09-12 [1] CRAN (R 4.4.2)
 MASS           7.3-60.0.1 2024-01-13 [4] CRAN (R 4.3.2)
 memoise        2.0.1      2021-11-26 [2] CRAN (R 4.3.3)
 mime           0.13       2025-03-17 [1] CRAN (R 4.4.2)
 miniUI         0.1.1.1    2018-05-18 [2] CRAN (R 4.3.3)
 mnormt         2.1.1      2022-09-26 [1] CRAN (R 4.4.2)
 pbivnorm       0.6.0      2015-01-23 [1] CRAN (R 4.4.2)
 pdftools       3.6.0      2025-09-10 [1] CRAN (R 4.4.2)
 pillar         1.10.1     2025-01-07 [2] CRAN (R 4.3.3)
 pkgbuild       1.4.6      2025-01-16 [2] CRAN (R 4.3.3)
 pkgconfig      2.0.3      2019-09-22 [2] CRAN (R 4.3.3)
 pkgload        1.4.0      2024-06-28 [2] CRAN (R 4.3.3)
 profvis        0.4.0      2024-09-20 [2] CRAN (R 4.3.3)
 promises       1.3.2      2024-11-28 [2] CRAN (R 4.3.3)
 purrr          1.0.4      2025-02-05 [1] CRAN (R 4.4.2)
 qpdf           1.4.1      2025-07-02 [1] CRAN (R 4.4.2)
 quadprog       1.5-8      2019-11-20 [1] CRAN (R 4.4.2)
 R6             2.6.1      2025-02-15 [1] CRAN (R 4.4.2)
 RColorBrewer   1.1-3      2022-04-03 [1] CRAN (R 4.4.2)
 Rcpp           1.1.0      2025-07-02 [1] CRAN (R 4.4.2)
 remotes        2.5.0      2024-03-17 [2] CRAN (R 4.3.3)
 rlang          1.1.6      2025-04-11 [1] CRAN (R 4.4.2)
 rmarkdown      2.30       2025-09-28 [1] CRAN (R 4.4.2)
 rstudioapi     0.17.1     2024-10-22 [2] CRAN (R 4.3.3)
 S7             0.2.0      2024-11-07 [1] CRAN (R 4.4.2)
 sass           0.4.10     2025-04-11 [1] CRAN (R 4.4.2)
 scales         1.4.0      2025-04-24 [1] CRAN (R 4.4.2)
 semPower       2.1.3      2025-08-22 [1] CRAN (R 4.4.2)
 sessioninfo    1.2.2      2021-12-06 [2] CRAN (R 4.3.3)
 shiny          1.10.0     2024-12-14 [2] CRAN (R 4.3.3)
 tibble         3.2.1      2023-03-20 [2] CRAN (R 4.3.3)
 tidyr        * 1.3.1      2024-01-24 [1] CRAN (R 4.4.2)
 tidyselect     1.2.1      2024-03-11 [1] CRAN (R 4.4.2)
 tinytex        0.57       2025-04-15 [1] CRAN (R 4.4.2)
 urlchecker     1.0.1      2021-11-30 [1] CRAN (R 4.4.2)
 usethis        3.1.0      2024-11-26 [2] CRAN (R 4.3.3)
 vctrs          0.6.5      2023-12-01 [2] CRAN (R 4.3.3)
 viridis      * 0.6.5      2024-01-29 [1] CRAN (R 4.4.2)
 viridisLite  * 0.4.2      2023-05-02 [1] CRAN (R 4.4.2)
 withr          3.0.2      2024-10-28 [2] CRAN (R 4.3.3)
 xfun           0.53       2025-08-19 [1] CRAN (R 4.4.2)
 xtable         1.8-4      2019-04-21 [2] CRAN (R 4.3.3)
 yaml           2.3.10     2024-07-26 [1] CRAN (R 4.4.2)

 [1] /home/clement/R/x86_64-pc-linux-gnu-library/4.4
 [2] /usr/local/lib/R/site-library
 [3] /usr/lib/R/site-library
 [4] /usr/lib/R/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</details>
<!-- ```{r} -->
<!-- model5 <- ' -->
<!-- # MODELE DE MESURE -->
<!-- CompSoc =~ compSoc1 + compSoc2 + compSoc3 + compSoc4 + compSoc5 + compSoc6 + compSoc7 + compSoc8 -->
<!-- CompTemp =~ compTemp1 + compTemp2 + compTemp3 + compTemp4 + compTemp5 + compTemp6 + compTemp7 + compTemp8 -->
<!-- ES =~ es1 + es2 + es3 + es4 + es5 + es6 + es7 + es8 + es9 + es10 -->
<!-- Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16 -->
<!-- # Structural model -->
<!-- CompSoc ~ 1 + c1 * Spirit -->
<!-- CompTemp ~ 1 + b1 * Spirit + b2 * CompSoc -->
<!-- ES ~ 1 + a1 * Spirit + a2 * CompSoc + a3 * CompTemp -->
<!-- Direct := a1 -->
<!-- Indirect1 := (c1 * a2)  -->
<!-- Indirect2 := (b1 * a3) -->
<!-- Indirect3 := (c1 * b2 * a3) -->
<!-- Indirect := (c1 * a2) + (b1 * a3) + (c1 * b2 * a3) -->
<!-- Total := Direct + Indirect -->
<!-- ' -->
<!-- fit5 = sem( -->
<!--   model5, -->
<!--   data = SSPM_data, -->
<!--   std.lv = T, -->
<!--   se = "boot", -->
<!--   bootstrap = 100 -->
<!-- ) -->
<!-- summary(fit5, fit = T, rsquare = T) -->
<!-- ``` -->


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/clement-poupelin\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Structural equation modeling and application in psychology (WIP)"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Clément Poupelin"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 10-14-2025</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: false</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["Structural Equation Modeling", "Psychology"]</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "This study was made during the Supervised Study Project in Mathematics (SSPM) of the first year of master"</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true </span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false </span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">  error: true</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Intervenant.e.s --&gt;</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Rédaction --&gt;</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   **Clément Poupelin**, [clementjc.poupelin\@gmail.com](mailto:clementjc.poupelin@gmail.com){.email}\ --&gt;</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> Relecture --&gt;</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -    --&gt;</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r tikz, engine = 'tikz', echo = FALSE, fig.width=6, fig.height=4} --&gt;</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \usetikzlibrary{shapes.geometric, arrows.meta, positioning} --&gt;</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \tikzstyle{decision} = [diamond, draw, fill=white] --&gt;</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \tikzstyle{line} = [draw, -Stealth, thick] --&gt;</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered] --&gt;</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em] --&gt;</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \begin{tikzpicture} %[scale=0.5, transform shape] --&gt;</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % scale=1.2 agrandit tout de 20 %. --&gt;</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- % transform shape permet de garder la mise à l’échelle du texte aussi. --&gt;</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     % Create Blocks --&gt;</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     \node [elli, fill = green!30!white] (compS) {Social comparison}; --&gt;</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     \node [elli, fill = magenta!30!white, below of = compS, yshift=-3em, xshift=6em] (selfE) {Self-esteem}; --&gt;</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     \node [elli, fill = orange!30!white, below of = compS, yshift=-3em, xshift=-6em] (spirit) {Spirituality}; --&gt;</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     % Add Arrows --&gt;</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     \path [line] (spirit) -- node[midway, above left] {$\beta = 0.45^{***}$} (compS); --&gt;</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     \path [line] (compS) -- node[midway, right] {$\beta = 0.60^{***}$} (selfE); --&gt;</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     \path [line] (spirit) -- node[midway, below] {$\beta = 0.25^{*}$} (selfE); --&gt;</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \end{tikzpicture} --&gt;</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### packages</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)    <span class="do">## Data manipulation</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)    <span class="do">## Data manipulation</span></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="do">## Plots</span></span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)  <span class="do">## Colorblind palet</span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)   <span class="do">## Structural equation modeling</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github('SachaEpskamp/semPlot')</span></span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a><span class="co"># library(semPlot)</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a><span class="fu">### Functions</span></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>create_barplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title, <span class="at">palette =</span> <span class="st">"viridis"</span>) {</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Item"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>)</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Response), <span class="at">fill =</span> <span class="fu">factor</span>(Response))) <span class="sc">+</span></span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> Item, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># 2 colonnes pour le facet</span></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title, <span class="at">x =</span> <span class="st">"Response"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> palette, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">32</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Personnalisation des titres des facets</span></span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>  <span class="co"># Pas besoin de légende redondante</span></span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a><span class="fu">### Seed</span></span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">140400</span>)</span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Abstract</span></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a>This tutorial provides a simple application of Structural Equation Modeling (SEM) to introduce the concept using a modified and simplified version of the dataset from the article "<span class="co">[</span><span class="ot">Explicit spirituality, self-esteem and the mechanisms of social and temporal comparison</span><span class="co">](https://dergipark.org.tr/en/download/article-file/2592756)</span>" by Justine Ollivaud, Jean-Michel Galharret, and Nicolas Roussiau.\</span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a>The analysis focuses on the psychological research domain, specifically examining the impact of spirituality on self-esteem, mediated by social and temporal comparison mechanisms. The goal is to offer a practical, accessible introduction to SEM for researchers and students interested in psychological data analysis.</span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import Data</span></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>The dataset used in this study is imported in .csv format and we remove all missing values with the <span class="in">`na.omit()`</span> function.</span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a>SSPM_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Documents/1_Projet/Perso/SSPM_data.csv"</span>)</span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a><span class="co"># remove missing values</span></span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>SSPM_data <span class="ot">&lt;-</span> SSPM_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">47</span>] <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>It includes <span class="in">`r nrow(SSPM_data)`</span> individuals. They are characterized by the <span class="in">`r ncol(SSPM_data)`</span> following variables :</span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a><span class="ss"> -  </span><span class="in">`Identifiant`</span> : integer assigned to the individual</span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`spirit1`</span>, $\cdots$ , <span class="in">`spirit16`</span> : answers of the individual for the 16 questions which relate to spirituality</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`Score_Spirit`</span> : total score of the individual for the questions which relate to spirituality</span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`CompSoc1`</span>, $\cdots$ , <span class="in">`CompSoc8`</span> : answers of the individual for the 8 questions which relate to social comparison</span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`Score_CompS`</span> : total score of the individual for the questions which relate to social comparison</span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`CompTemp1`</span>, $\cdots$ , <span class="in">`CompTemp8`</span> : answers of the individual for the 8 questions which relate to temporal comparison</span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`Score_CompT`</span> : total score of the individual for the questions which relate to temporal comparison</span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`es1`</span>, $\cdots$ , <span class="in">`es10`</span> : answers of the individual for the 10 questions which relate to self esteem</span>
<span id="cb46-156"><a href="#cb46-156" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span><span class="in">`Score_ES`</span> : total score of the individual for the questions which relate to self esteem</span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a> <span class="co">&lt;!-- - `Sexe` : sexe of the individual --&gt;</span></span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a> <span class="co">&lt;!-- - `Age` : age of the individual --&gt;</span></span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a> <span class="co">&lt;!-- - `Croy_Rel` : belief or not of the individual to religion --&gt;</span></span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a>SSPM_data <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a>For this analysis, only positively worded items are retained:</span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Select positively worded items</span></span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a>es_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a>                      <span class="at">select =</span> <span class="fu">c</span>(es3, es5, es8, es9, es10)) </span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>compSoc_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a>                           <span class="at">select =</span> <span class="fu">c</span>(compSoc1, compSoc3, compSoc4, compSoc6))</span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a>compTemp_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a>                            <span class="at">select =</span> <span class="fu">c</span>(compTemp1, compTemp3, compTemp4, compTemp6))</span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a>spirit_selected <span class="ot">&lt;-</span> <span class="fu">subset</span>(SSPM_data,</span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a>                          <span class="at">select =</span> <span class="fu">c</span>(spirit1, spirit2, spirit3, spirit4, spirit5, spirit6, spirit7, spirit8, spirit9, spirit10, spirit11, spirit12, spirit13, spirit14, spirit15, spirit16))</span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a>es_selected <span class="sc">%&gt;%</span> </span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>compSoc_selected <span class="sc">%&gt;%</span> </span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a>compTemp_selected <span class="sc">%&gt;%</span> </span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a>spirit_selected <span class="sc">%&gt;%</span> </span>
<span id="cb46-194"><a href="#cb46-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminary analysis</span></span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a><span class="fu">### Descriptive analysis</span></span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a>To represent the distribution of responses to each questionnaire item, we use barplots. This approach is more intuitive for categorical questionnaire data. We also use facet grids to separate items by construct (e.g., self-esteem, social comparison).\</span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a>Note that colors can be chosen to be accessible to colorblind individuals.</span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Self-Esteem</span></span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=16, fig.height=14}</span></span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a><span class="in">create_barplot(es_selected, "Selected Self-Esteem Items", palette = "D")</span></span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spirituality</span></span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-215"><a href="#cb46-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=16, fig.height=18}</span></span>
<span id="cb46-216"><a href="#cb46-216" aria-hidden="true" tabindex="-1"></a><span class="in">create_barplot(spirit_selected, "Spirituality Items", palette = "A")</span></span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## Social Comparison</span></span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=16, fig.height=14}</span></span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a><span class="in">create_barplot(compSoc_selected, "Selected Social Comparison Items", palette = "E")</span></span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## Temporal Comparison</span></span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=16, fig.height=14}</span></span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a><span class="in">create_barplot(compTemp_selected, "Selected Temporal Comparison Items", palette = "F")</span></span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Model</span></span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>We fit two linear models to explore the relationships between spirituality, social/temporal comparison, and self-esteem:</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Model 1 (M1): Social comparison as a function of spirituality</span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Model 2 (M2): Self-esteem as a function of social comparison and spirituality</span>
<span id="cb46-241"><a href="#cb46-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model 1 </span></span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear models</span></span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score_CompS <span class="sc">~</span> Score_Spirit, <span class="at">data =</span> SSPM_data)</span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize M1 with added-variable plots</span></span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(M1)</span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model 2</span></span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear models</span></span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score_ES <span class="sc">~</span> Score_CompS <span class="sc">+</span> Score_Spirit, <span class="at">data =</span> SSPM_data)</span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize M2 with added-variable plots</span></span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">avPlots</span>(M2)</span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a>M1 tests the direct effect of spirituality on social comparison and M2 tests the combined effect of social comparison and spirituality on self-esteem.</span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a>Then, the avPlots function helps visualize the contribution of each predictor, adjusting for the others.</span>
<span id="cb46-279"><a href="#cb46-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-280"><a href="#cb46-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### From Linear Models to Structural Equation Modeling: Why SEM Matters</span></span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a>In the preliminary analysis, we used linear regression models (lm) to explore the relationships between spirituality, social/temporal comparison, and self-esteem. These models rely on composite scores—that is, the total or average scores derived from summing or averaging responses to multiple questionnaire items (e.g., Score_Spirit, Score_CompS, Score_ES). While this approach is straightforward and easy to interpret, it has several limitations:</span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**Loss of Nuance**: By aggregating individual items into a single score, we assume that all items contribute equally to the underlying construct (e.g., spirituality or self-esteem). This ignores the possibility that some items may be more relevant or reliable than others, or that the construct itself is multidimensional.</span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**Measurement Error**: Composite scores are treated as perfectly measured variables, which is rarely true in practice. Measurement error (e.g., due to poorly worded questions or individual differences in interpretation) can bias the estimated relationships between variables.</span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**Limited Theoretical Flexibility**: Linear regression cannot explicitly model complex theoretical relationships, such as mediation, moderation, or latent variables (unobserved constructs inferred from observed variables).</span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a>**Structural Equation Modeling (SEM) addresses these limitations by offering a more sophisticated and theoretically grounded framework for analyzing relationships between variables**.\</span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structural Equation Modeling</span></span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Theory</span></span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a>For a quick understanding, we propose an example of SEM (For more details, do not hesitate to see the dedicated publication <span class="co">[</span><span class="ot">Structural equation modeling and application in psychology</span><span class="co">](https://github.com/Clement-Poupelin/Clement-Poupelin.github.io/blob/main/docs/SSPM_Aela_JAGOT_Clement_POUPELIN_M1IS.pdf)</span>).</span>
<span id="cb46-298"><a href="#cb46-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, engine = 'tikz', echo = FALSE, fig.width=6, fig.height=4, fig.align='center'}</span></span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric, arrows.meta, positioning}</span></span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{decision} = [diamond, draw, fill=white]</span></span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{line} = [draw, -Stealth, thick]</span></span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered]</span></span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em]</span></span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a><span class="in">        % Create Blocks</span></span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a><span class="in">        % M et ses items</span></span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = red!30!white] (M) {$M$};</span></span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [block, fill = gray!20!white, above of = M, yshift=0.5em, xshift=-8em] (m1) {$m_1$};</span></span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [above of = M, yshift=2em, xshift=0em] (m2) {$\textbf{. . .}$};</span></span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [block, fill = gray!20!white, above of = M, yshift=0.5em, xshift=8em] (mr) {$m_r$};</span></span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = gray!20!white, above of = m1, yshift=1em, xshift=-1em] (xim1) {$\xi_{m_1}$};</span></span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = gray!20!white, above of = mr, yshift=1em, xshift=1em] (ximr) {$\xi_{m_r}$};</span></span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = red!30!white, below of = M, yshift=0.5em, xshift=-6em] (epsM) {$\mathcal{E}_M$};</span></span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a><span class="in">        % Y et ses items</span></span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = red!30!white, below of = M, yshift=-6em, xshift=9em] (Y) {\(Y\)};</span></span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [block, fill = gray!20!white, right of = Y, yshift=4em, xshift=3em] (y1) {$y_1$};</span></span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [ right of = Y, yshift=0em, xshift=8em] (y2) {$\textbf{. . .}$};</span></span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [block, fill = gray!20!white, right of = Y, yshift=-4em, xshift=1em] (yt) {$y_t$};        </span></span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = gray!20!white, above of = y1, yshift=1em, xshift=4em] (xiy1) {$\xi_{y_1}$};</span></span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = gray!20!white, below of = yt, yshift=-1em, xshift=4em] (xiyt) {$\xi_{y_t}$};</span></span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = red!30!white, right of = Y, yshift=-4em, xshift=-6em] (epsY) {$\mathcal{E}_Y$};</span></span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a><span class="in">        % X et ses items</span></span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = red!30!white, below of = M, yshift=-10em, xshift=-10em] (X) {\(X\)};</span></span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [block, fill = gray!20!white, left of = X, yshift=-4em, xshift=1em] (x1) {$x_s$};</span></span>
<span id="cb46-331"><a href="#cb46-331" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [left of = X, yshift=0em, xshift=-8em] (x2) {$\textbf{. . .}$};</span></span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [block, fill = gray!20!white, left of = X, yshift=4em, xshift=-2em] (xs) {$x_1$};        </span></span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = gray!20!white, above of = xs, yshift=1em, xshift=-4em] (xixs) {$\xi_{x_1}$};</span></span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [circle, fill = gray!20!white, below of = x1, yshift=-1em, xshift=-3em] (xix1) {$\xi_{x_s}$};</span></span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a><span class="in">        % Add Arrows</span></span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (X) -- (M);</span></span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (M) -- (Y);</span></span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (X) -- (Y);</span></span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (M) -- (m1);</span></span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (M) -- (mr);</span></span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (xim1) -- (m1);</span></span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (ximr) -- (mr);</span></span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (epsM) -- (M);</span></span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (Y) -- (y1);</span></span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (Y) -- (yt);</span></span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (xiy1) -- (y1);</span></span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (xiyt) -- (yt);</span></span>
<span id="cb46-352"><a href="#cb46-352" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (epsY) -- (Y);</span></span>
<span id="cb46-353"><a href="#cb46-353" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (X) -- (x1);</span></span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (X) -- (xs);        </span></span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (xix1) -- (x1);</span></span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (xixs) -- (xs);</span></span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-362"><a href="#cb46-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a>This model can be interpreted as a study aiming to explain the direct effect of $X$ on $Y$ and the indirect effect of $X$ on $Y$ through $M$. The latter variable is called the **mediation variable**. In detail, we have:</span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-365"><a href="#cb46-365" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$Y$ and $M$ are latent endogenous variables</span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$X$ is a latent exogenous variable</span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$m_i$ are observed endogenous variables, for $i \in <span class="sc">\{</span>1, ..., r<span class="sc">\}</span>$</span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$x_j$ are observed exogenous variables, for $j \in <span class="sc">\{</span>1, ..., s<span class="sc">\}</span>$</span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y_k$ are observed endogenous variables, for $k \in <span class="sc">\{</span>1, ..., t<span class="sc">\}</span>$</span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a>We can rewrite the model as a system:</span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>\textbf{Measurement model} <span class="sc">\\</span></span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a>m_i = \gamma_i M + \xi_{m_i}, \quad \text{for } i \in <span class="sc">\{</span>1, ..., r<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a>x_j = \alpha_j X + \xi_{x_j}, \quad \text{for } j \in <span class="sc">\{</span>1, ..., s<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb46-378"><a href="#cb46-378" aria-hidden="true" tabindex="-1"></a>y_k = \beta_k Y + \xi_{y_k}, \quad \text{for } k \in <span class="sc">\{</span>1, ..., t<span class="sc">\}</span> <span class="sc">\\</span></span>
<span id="cb46-379"><a href="#cb46-379" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a>\textbf{Structural Model} <span class="sc">\\</span></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a>M = b_0 + b_1 X + \mathcal{E}_{M} <span class="sc">\\</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a>Y = a_0 + a_1 X + a_2 M + \mathcal{E}_Y</span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a>We can also rewrite the structural model in the form of a matrix equation:</span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a>M <span class="sc">\\</span></span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>Y</span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a>b_0 <span class="sc">\\</span></span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a>a_0</span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>b_1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a>a_1 &amp; a_2</span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a>X <span class="sc">\\</span></span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a>M</span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a>\mathcal{E}_{M} <span class="sc">\\</span></span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a>\mathcal{E}_Y</span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a>Now, thanks to the way we wrote the model, we can make the different effects explicit. To do this, we take the structural model and substitute the first line into the second line:</span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a>M = b_0 + b_1 X + \mathcal{E}_{M} <span class="sc">\\</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a>Y = a_0 + a_1 X + a_2 M + \mathcal{E}_Y</span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a>$\Leftrightarrow Y = a_0 + a_1 X + a_2 (b_0 + b_1 X + \mathcal{E}_{M}) + \mathcal{E}_Y$</span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a>$\Leftrightarrow Y = a_0 + a_2 b_0 + a_1 X + a_2 b_1 X + \mathcal{E}'$</span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a>$\Leftrightarrow Y = (a_0 + a_2 b_0) + (a_1 + a_2 b_1) X + \mathcal{E}'$</span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a>Here, $\quad \mathcal{E}' = a_2 \mathcal{E}_{M} + \mathcal{E}_Y$ with $\mathcal{E}' \in <span class="co">[</span><span class="ot">X</span><span class="co">]</span>^\bot$ because $\mathcal{E}_M \in <span class="co">[</span><span class="ot">X</span><span class="co">]</span>^\bot$ and $\mathcal{E}_Y \in <span class="co">[</span><span class="ot">X, M</span><span class="co">]</span>^\bot$\</span>
<span id="cb46-430"><a href="#cb46-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-431"><a href="#cb46-431" aria-hidden="true" tabindex="-1"></a>Therefore, we can write the effects of $X$ on $Y$:</span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a>\underbrace{\overbrace{a_2 b_1}^{\text{Indirect effect}} + \overbrace{a_1}^{\text{Direct effect}}}_{\text{Total effect}}</span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a><span class="fu">### Application</span></span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a>We build several model which connects the latent variables **Spirituality, Social comparison, Temporal comparison and Self esteem**.\</span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a>Each of them being determined by different observed variables. </span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Programming with `lavaan` </span></span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a>The library <span class="in">`lavaan`</span> on <span class="in">`R`</span> is usually used to estimate a large variety of multivariate statistical models, like structural equation modeling. For information, this package also permit to estimate path analysis, confirmatory factor analysis and growth curve models.\</span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a>To programm a structural equation modeling on <span class="in">`R`</span>, we proceed like this :</span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-449"><a href="#cb46-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-450"><a href="#cb46-450" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a>    &amp; \text{Model &lt;- `}<span class="sc">\\</span></span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a>    &amp; \quad <span class="sc">\#</span> \; \text{latent variables} <span class="sc">\\</span></span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a>    &amp; \quad \quad X =\sim x_1 + x_2 + x_3 <span class="sc">\\</span></span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a>    &amp; \quad \quad M =\sim m_1 + m_2 + m_3 <span class="sc">\\</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a>    &amp; \quad \quad Y =\sim y_1 + y_2 + y_3<span class="sc">\\</span></span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a>    &amp; \quad <span class="sc">\#</span> \; \text{regressions} <span class="sc">\\</span></span>
<span id="cb46-457"><a href="#cb46-457" aria-hidden="true" tabindex="-1"></a>    &amp; \quad \quad M \sim X <span class="sc">\\</span></span>
<span id="cb46-458"><a href="#cb46-458" aria-hidden="true" tabindex="-1"></a>    &amp; \quad \quad Y \sim M + X<span class="sc">\\</span></span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a>    &amp; \quad <span class="sc">\#</span> \; \text{residual covariances} <span class="sc">\\</span></span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a>    &amp; \quad \quad x_1 \sim \sim x_2 \quad \text{`}</span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb46-462"><a href="#cb46-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-463"><a href="#cb46-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a>We can recognize different types of operators :</span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>$=\sim$ : indicate by which observed variables is measured the latent variable</span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>$\sim \;\;\;$ : indicate by which linear regression is estimate the latent variable</span>
<span id="cb46-468"><a href="#cb46-468" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>$\sim\sim$ : indicate the covariance between residuals</span>
<span id="cb46-469"><a href="#cb46-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-470"><a href="#cb46-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a>Then, to fit the model we use the following function : </span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a>fit &lt;- sem(\text{model} = \text{Model}, \text{ data})</span>
<span id="cb46-475"><a href="#cb46-475" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb46-476"><a href="#cb46-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-477"><a href="#cb46-477" aria-hidden="true" tabindex="-1"></a>To make a summary on <span class="in">`fit`</span> permit to obtain some informations like the AIC criterion and the BIC criterion of the model but also an estimation of the differents coefficients.\</span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a>Furthermore, there is also possible to do a SEM on <span class="in">`Python`</span> with the package <span class="in">`semopy`</span>. The method used is similar to the one used with <span class="in">`lavaan`</span> and the estimations are very closed.</span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-481"><a href="#cb46-481" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Determination of the latent variables</span></span>
<span id="cb46-482"><a href="#cb46-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a>Before to model the data frame, it is necessary to determine the four latent variables that will be used in the different models : **Spirituality**, **Social comparison**, **Temporal comparison** and **Self-esteem**.\</span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a>For the variable **Spirituality**, we preserve all the observed variables of the study. Nevertheless, for **Social comparison**, **Temporal comparison** and **Self-esteem** we only keep the observed variables which have positive coefficients. We can summarize the number of observed variables per latent variables in the following tabular.\</span>
<span id="cb46-485"><a href="#cb46-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-486"><a href="#cb46-486" aria-hidden="true" tabindex="-1"></a>   **Latent Variables**       | **Number of Observed Variables** |</span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a> |-----------------------------|----------------------------------|</span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a> | Spirituality                | 16                               |</span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a> | Social comparison           | 4                                |</span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a> | Temporal comparison         | 4                                |</span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a> | Self-esteem                 | 5                                |</span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a>*Table 2: Number of observed variables per latent variable*</span>
<span id="cb46-494"><a href="#cb46-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-495"><a href="#cb46-495" aria-hidden="true" tabindex="-1"></a>We can express the measurement model for the latent variables with their corresponding observed variables in the form of equations:</span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a>\textsf{Spirituality} = \sim \textit{spirit1 + spirit2 + spirit3 + spirit4 + spirit5} <span class="sc">\\</span></span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a>\quad \quad \quad \quad \quad \quad \quad + \textit{spirit6 + spirit7 + spirit8 + spirit9 + spirit10} <span class="sc">\\</span></span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a>\quad \quad \quad \quad \quad \quad \quad + \textit{spirit11 + spirit12 + spirit13 + spirit14 + spirit15} <span class="sc">\\</span></span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a>\quad \quad \quad \quad \quad \quad \quad + \textit{spirit16} <span class="sc">\\</span></span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a>\textsf{Social comparison} = \sim \textit{compSoc1 + compSoc3 + compSoc4 + compSoc6} <span class="sc">\\</span></span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a>\textsf{Temporal comparison} = \sim \textit{compTemp1 + compTemp3 + compTemp4} <span class="sc">\\</span></span>
<span id="cb46-507"><a href="#cb46-507" aria-hidden="true" tabindex="-1"></a>\quad \quad \quad \quad \quad \quad \quad \quad \quad + \textit{compTemp6}<span class="sc">\\</span></span>
<span id="cb46-508"><a href="#cb46-508" aria-hidden="true" tabindex="-1"></a><span class="sc">\\</span></span>
<span id="cb46-509"><a href="#cb46-509" aria-hidden="true" tabindex="-1"></a>\textsf{Self-esteem} = \sim \textit{es3 + es5 + es8 + es9 + es10}</span>
<span id="cb46-510"><a href="#cb46-510" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-511"><a href="#cb46-511" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-512"><a href="#cb46-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-513"><a href="#cb46-513" aria-hidden="true" tabindex="-1"></a>Disposing of all our latent variables, it is possible to build different models of structural equations.</span>
<span id="cb46-514"><a href="#cb46-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-515"><a href="#cb46-515" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model 1</span></span>
<span id="cb46-516"><a href="#cb46-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-517"><a href="#cb46-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, engine = 'tikz', echo = FALSE, fig.width=4, fig.height=2, fig.align='center'}</span></span>
<span id="cb46-518"><a href="#cb46-518" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric, arrows.meta, positioning}</span></span>
<span id="cb46-519"><a href="#cb46-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-520"><a href="#cb46-520" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{decision} = [diamond, draw, fill=white]</span></span>
<span id="cb46-521"><a href="#cb46-521" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{line} = [draw, -Stealth, thick]</span></span>
<span id="cb46-522"><a href="#cb46-522" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered]</span></span>
<span id="cb46-523"><a href="#cb46-523" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em]</span></span>
<span id="cb46-524"><a href="#cb46-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-525"><a href="#cb46-525" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb46-526"><a href="#cb46-526" aria-hidden="true" tabindex="-1"></a><span class="in">        % Create Blocks</span></span>
<span id="cb46-527"><a href="#cb46-527" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = green!30!white] (compS) {Social comparison};</span></span>
<span id="cb46-528"><a href="#cb46-528" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = magenta!30!white, below of = compS, yshift=-3em, xshift=6em] (selfE) {Self-esteem};</span></span>
<span id="cb46-529"><a href="#cb46-529" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = orange!30!white, below of = compS, yshift=-3em, xshift=-6em] (spirit) {Spirituality};</span></span>
<span id="cb46-530"><a href="#cb46-530" aria-hidden="true" tabindex="-1"></a><span class="in">        % Add Arrows</span></span>
<span id="cb46-531"><a href="#cb46-531" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (compS);</span></span>
<span id="cb46-532"><a href="#cb46-532" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compS) -- (selfE);</span></span>
<span id="cb46-533"><a href="#cb46-533" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (selfE);</span></span>
<span id="cb46-534"><a href="#cb46-534" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb46-535"><a href="#cb46-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-536"><a href="#cb46-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-539"><a href="#cb46-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-540"><a href="#cb46-540" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb46-541"><a href="#cb46-541" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb46-542"><a href="#cb46-542" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc =~ compSoc1 + compSoc3 + compSoc4 + compSoc6</span></span>
<span id="cb46-543"><a href="#cb46-543" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb46-544"><a href="#cb46-544" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb46-545"><a href="#cb46-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-546"><a href="#cb46-546" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb46-547"><a href="#cb46-547" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc ~ 1 + b1 * Spirit</span></span>
<span id="cb46-548"><a href="#cb46-548" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompSoc</span></span>
<span id="cb46-549"><a href="#cb46-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-550"><a href="#cb46-550" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1 </span></span>
<span id="cb46-551"><a href="#cb46-551" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := b1 * a2</span></span>
<span id="cb46-552"><a href="#cb46-552" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb46-553"><a href="#cb46-553" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb46-554"><a href="#cb46-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-555"><a href="#cb46-555" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb46-556"><a href="#cb46-556" aria-hidden="true" tabindex="-1"></a>  model1,</span>
<span id="cb46-557"><a href="#cb46-557" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The structural equation model</span></span>
<span id="cb46-558"><a href="#cb46-558" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb46-559"><a href="#cb46-559" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The dataset containing the variables to be analyzed</span></span>
<span id="cb46-560"><a href="#cb46-560" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb46-561"><a href="#cb46-561" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Standardization of latent variables</span></span>
<span id="cb46-562"><a href="#cb46-562" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T (TRUE): Latent variables will be standardized (mean=0, standard deviation=1)</span></span>
<span id="cb46-563"><a href="#cb46-563" aria-hidden="true" tabindex="-1"></a>  <span class="co"># F (FALSE): Latent variables will not be standardized (default)</span></span>
<span id="cb46-564"><a href="#cb46-564" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Useful for comparing coefficients across different models or studies</span></span>
<span id="cb46-565"><a href="#cb46-565" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb46-566"><a href="#cb46-566" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Method for estimating standard errors</span></span>
<span id="cb46-567"><a href="#cb46-567" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "boot": Uses bootstrapping to estimate standard errors</span></span>
<span id="cb46-568"><a href="#cb46-568" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Other possible options: "standard" (default), "robust", etc.</span></span>
<span id="cb46-569"><a href="#cb46-569" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bootstrapping is useful for small sample sizes or when normality assumptions are not met</span></span>
<span id="cb46-570"><a href="#cb46-570" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span>  <span class="co"># Number of bootstrap resamples</span></span>
<span id="cb46-571"><a href="#cb46-571" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 100: Number of bootstrap replications to perform</span></span>
<span id="cb46-572"><a href="#cb46-572" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Higher numbers provide more precise estimates but increase computation time</span></span>
<span id="cb46-573"><a href="#cb46-573" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A minimum of 100 is often recommended, but 1000 or more is ideal for stable results</span></span>
<span id="cb46-574"><a href="#cb46-574" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This parameter is only considered if se="boot"</span></span>
<span id="cb46-575"><a href="#cb46-575" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-576"><a href="#cb46-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-577"><a href="#cb46-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-578"><a href="#cb46-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-579"><a href="#cb46-579" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;&lt;summary&gt;<span class="in">`summary(fit1)`</span>&lt;/summary&gt;</span>
<span id="cb46-580"><a href="#cb46-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='markup'}</span></span>
<span id="cb46-581"><a href="#cb46-581" aria-hidden="true" tabindex="-1"></a><span class="in">summary(fit1, fit = T, rsquare = T)</span></span>
<span id="cb46-582"><a href="#cb46-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-583"><a href="#cb46-583" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt; </span>
<span id="cb46-584"><a href="#cb46-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-585"><a href="#cb46-585" aria-hidden="true" tabindex="-1"></a>The aim is to analyze direct and indirect effects on **Self-esteem** for the model <span class="in">`fit1`</span>. To reference the first part, we rename our latent variables:</span>
<span id="cb46-586"><a href="#cb46-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-587"><a href="#cb46-587" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-588"><a href="#cb46-588" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-589"><a href="#cb46-589" aria-hidden="true" tabindex="-1"></a>X := \textsf{Spirituality} <span class="sc">\\</span></span>
<span id="cb46-590"><a href="#cb46-590" aria-hidden="true" tabindex="-1"></a>M_1 := \textsf{Social comparison} <span class="sc">\\</span></span>
<span id="cb46-591"><a href="#cb46-591" aria-hidden="true" tabindex="-1"></a>Y := \textsf{Self-esteem}</span>
<span id="cb46-592"><a href="#cb46-592" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-593"><a href="#cb46-593" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-594"><a href="#cb46-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-595"><a href="#cb46-595" aria-hidden="true" tabindex="-1"></a>This is a **mediation model**. It is possible to analyze the direct and indirect effects on $Y$.\</span>
<span id="cb46-596"><a href="#cb46-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-597"><a href="#cb46-597" aria-hidden="true" tabindex="-1"></a>First, we make explicit the structural model and substitute in the expression of $Y$:</span>
<span id="cb46-598"><a href="#cb46-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-599"><a href="#cb46-599" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-600"><a href="#cb46-600" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-601"><a href="#cb46-601" aria-hidden="true" tabindex="-1"></a>M_1 = b_0 + b_1 X + \mathcal{E}_{M_1} <span class="sc">\\</span></span>
<span id="cb46-602"><a href="#cb46-602" aria-hidden="true" tabindex="-1"></a>Y = a_0 + a_1 X + a_2 M_1 + \mathcal{E}_Y</span>
<span id="cb46-603"><a href="#cb46-603" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-604"><a href="#cb46-604" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-605"><a href="#cb46-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-606"><a href="#cb46-606" aria-hidden="true" tabindex="-1"></a>$\Leftrightarrow Y = (a_0 + a_2 b_0) + (a_1 + a_2 b_1) X + \mathcal{E}'$</span>
<span id="cb46-607"><a href="#cb46-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-608"><a href="#cb46-608" aria-hidden="true" tabindex="-1"></a>We can verify that the model is identifiable by looking if the **degree of freedom is greater than 0** :</span>
<span id="cb46-611"><a href="#cb46-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-612"><a href="#cb46-612" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit1 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit1))</span>
<span id="cb46-613"><a href="#cb46-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-614"><a href="#cb46-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-615"><a href="#cb46-615" aria-hidden="true" tabindex="-1"></a>Finally, with the summary of the fit of the model <span class="in">`fit1`</span> in <span class="in">`R`</span>, we can build the following table:</span>
<span id="cb46-616"><a href="#cb46-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-617"><a href="#cb46-617" aria-hidden="true" tabindex="-1"></a>**Effect**   | **Expression** | **Estimate** | **Std.Err** | **P-value** |</span>
<span id="cb46-618"><a href="#cb46-618" aria-hidden="true" tabindex="-1"></a> |--------------|----------------|--------------|-------------|-------------|</span>
<span id="cb46-619"><a href="#cb46-619" aria-hidden="true" tabindex="-1"></a> | Direct       | $a_1$          | -0.034       | 0.061       | 0.582       |</span>
<span id="cb46-620"><a href="#cb46-620" aria-hidden="true" tabindex="-1"></a> | Indirect     | $a_2 b_1$      | -0.094       | 0.038       | 0.013       |</span>
<span id="cb46-621"><a href="#cb46-621" aria-hidden="true" tabindex="-1"></a> | Total        | $a_1 + a_2 b_1$| -0.128       | 0.060       | 0.033       |</span>
<span id="cb46-622"><a href="#cb46-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-623"><a href="#cb46-623" aria-hidden="true" tabindex="-1"></a>*Table 3: Effects on $Y$ for the model `fit1`*</span>
<span id="cb46-624"><a href="#cb46-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-625"><a href="#cb46-625" aria-hidden="true" tabindex="-1"></a>We can conclude that in the model <span class="in">`fit1`</span>, the **indirect effect is significant for the variable Self-esteem**.</span>
<span id="cb46-626"><a href="#cb46-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-627"><a href="#cb46-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-628"><a href="#cb46-628" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model 2</span></span>
<span id="cb46-629"><a href="#cb46-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-630"><a href="#cb46-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, engine = 'tikz', echo = FALSE, fig.width=4, fig.height=2, fig.align='center'}</span></span>
<span id="cb46-631"><a href="#cb46-631" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric, arrows.meta, positioning}</span></span>
<span id="cb46-632"><a href="#cb46-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-633"><a href="#cb46-633" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{decision} = [diamond, draw, fill=white]</span></span>
<span id="cb46-634"><a href="#cb46-634" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{line} = [draw, -Stealth, thick]</span></span>
<span id="cb46-635"><a href="#cb46-635" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered]</span></span>
<span id="cb46-636"><a href="#cb46-636" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em]</span></span>
<span id="cb46-637"><a href="#cb46-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-638"><a href="#cb46-638" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb46-639"><a href="#cb46-639" aria-hidden="true" tabindex="-1"></a><span class="in">        % Create Blocks</span></span>
<span id="cb46-640"><a href="#cb46-640" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = cyan!30!white] (compT) {Temporal comparison};</span></span>
<span id="cb46-641"><a href="#cb46-641" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = magenta!30!white, below of = compT, yshift=-3em, xshift=6em] (selfE) {Self-esteem};</span></span>
<span id="cb46-642"><a href="#cb46-642" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = orange!30!white, below of = compT, yshift=-3em, xshift=-6em] (spirit) {Spirituality};</span></span>
<span id="cb46-643"><a href="#cb46-643" aria-hidden="true" tabindex="-1"></a><span class="in">        % Add Arrows</span></span>
<span id="cb46-644"><a href="#cb46-644" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (compT);</span></span>
<span id="cb46-645"><a href="#cb46-645" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compT) -- (selfE);</span></span>
<span id="cb46-646"><a href="#cb46-646" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (selfE);</span></span>
<span id="cb46-647"><a href="#cb46-647" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb46-648"><a href="#cb46-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-649"><a href="#cb46-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-652"><a href="#cb46-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-653"><a href="#cb46-653" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb46-654"><a href="#cb46-654" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb46-655"><a href="#cb46-655" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp =~ compTemp1 + compTemp3 + compTemp4 + compTemp6 </span></span>
<span id="cb46-656"><a href="#cb46-656" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb46-657"><a href="#cb46-657" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb46-658"><a href="#cb46-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-659"><a href="#cb46-659" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb46-660"><a href="#cb46-660" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp ~ 1 + b1 * Spirit</span></span>
<span id="cb46-661"><a href="#cb46-661" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompTemp</span></span>
<span id="cb46-662"><a href="#cb46-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-663"><a href="#cb46-663" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1 </span></span>
<span id="cb46-664"><a href="#cb46-664" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := b1 * a2</span></span>
<span id="cb46-665"><a href="#cb46-665" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb46-666"><a href="#cb46-666" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb46-667"><a href="#cb46-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-668"><a href="#cb46-668" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb46-669"><a href="#cb46-669" aria-hidden="true" tabindex="-1"></a>  model2,</span>
<span id="cb46-670"><a href="#cb46-670" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb46-671"><a href="#cb46-671" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb46-672"><a href="#cb46-672" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb46-673"><a href="#cb46-673" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span></span>
<span id="cb46-674"><a href="#cb46-674" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-675"><a href="#cb46-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-676"><a href="#cb46-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-677"><a href="#cb46-677" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;&lt;summary&gt;<span class="in">`summary(fit2)`</span>&lt;/summary&gt;</span>
<span id="cb46-678"><a href="#cb46-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='markup'}</span></span>
<span id="cb46-679"><a href="#cb46-679" aria-hidden="true" tabindex="-1"></a><span class="in">summary(fit2, fit = T, rsquare = T)</span></span>
<span id="cb46-680"><a href="#cb46-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-681"><a href="#cb46-681" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt; </span>
<span id="cb46-682"><a href="#cb46-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-683"><a href="#cb46-683" aria-hidden="true" tabindex="-1"></a>The aim is to analyze direct and indirect effects on **Self-esteem** for the model <span class="in">`fit2`</span>. To reference the first part, we rename our latent variables:</span>
<span id="cb46-684"><a href="#cb46-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-685"><a href="#cb46-685" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-686"><a href="#cb46-686" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-687"><a href="#cb46-687" aria-hidden="true" tabindex="-1"></a>X := \textsf{Spirituality} <span class="sc">\\</span></span>
<span id="cb46-688"><a href="#cb46-688" aria-hidden="true" tabindex="-1"></a>M_2 := \textsf{Temporal comparison} <span class="sc">\\</span></span>
<span id="cb46-689"><a href="#cb46-689" aria-hidden="true" tabindex="-1"></a>Y := \textsf{Self-esteem}</span>
<span id="cb46-690"><a href="#cb46-690" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-691"><a href="#cb46-691" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-692"><a href="#cb46-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-693"><a href="#cb46-693" aria-hidden="true" tabindex="-1"></a>This is still a **mediation model**. It is possible to analyze the direct and indirect effects on $Y$.\</span>
<span id="cb46-694"><a href="#cb46-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-695"><a href="#cb46-695" aria-hidden="true" tabindex="-1"></a>First, we make explicit the structural model and substitute in the expression of $Y$:</span>
<span id="cb46-696"><a href="#cb46-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-697"><a href="#cb46-697" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-698"><a href="#cb46-698" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-699"><a href="#cb46-699" aria-hidden="true" tabindex="-1"></a>M_2 = b_0 + b_1 X + \mathcal{E}_{M_2} <span class="sc">\\</span></span>
<span id="cb46-700"><a href="#cb46-700" aria-hidden="true" tabindex="-1"></a>Y = a_0 + a_1 X + a_2 M_2 + \mathcal{E}_Y</span>
<span id="cb46-701"><a href="#cb46-701" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-702"><a href="#cb46-702" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-703"><a href="#cb46-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-704"><a href="#cb46-704" aria-hidden="true" tabindex="-1"></a>$\Leftrightarrow Y = (a_0 + a_2 b_0) + (a_1 + a_2 b_1) X + \mathcal{E}'$</span>
<span id="cb46-705"><a href="#cb46-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-706"><a href="#cb46-706" aria-hidden="true" tabindex="-1"></a>We can verify that the model is identifiable by looking if the **degree of freedom is greater than 0** :</span>
<span id="cb46-709"><a href="#cb46-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-710"><a href="#cb46-710" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit2 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit2))</span>
<span id="cb46-711"><a href="#cb46-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-712"><a href="#cb46-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-713"><a href="#cb46-713" aria-hidden="true" tabindex="-1"></a>Finally, with the summary of the fit of the model <span class="in">`fit2`</span> in <span class="in">`R`</span>, we can build the following table:</span>
<span id="cb46-714"><a href="#cb46-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-715"><a href="#cb46-715" aria-hidden="true" tabindex="-1"></a>**Effect**   | **Expression** | **Estimate** | **Std.Err** | **P-value** |</span>
<span id="cb46-716"><a href="#cb46-716" aria-hidden="true" tabindex="-1"></a> |--------------|----------------|--------------|-------------|-------------|</span>
<span id="cb46-717"><a href="#cb46-717" aria-hidden="true" tabindex="-1"></a> | Direct       | $a_1$          | -0.128       | 0.058       | 0.026       |</span>
<span id="cb46-718"><a href="#cb46-718" aria-hidden="true" tabindex="-1"></a> | Indirect     | $a_2 b_1$      |  0.004       | 0.012       | 0.723       |</span>
<span id="cb46-719"><a href="#cb46-719" aria-hidden="true" tabindex="-1"></a> | Total        | $a_1 + a_2 b_1$| -0.124       | 0.057       | 0.030       |</span>
<span id="cb46-720"><a href="#cb46-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-721"><a href="#cb46-721" aria-hidden="true" tabindex="-1"></a>*Table ?????,: Effects on $Y$ for the model `fit2`*</span>
<span id="cb46-722"><a href="#cb46-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-723"><a href="#cb46-723" aria-hidden="true" tabindex="-1"></a>We can conclude that in the model <span class="in">`fit2`</span>, the **direct effect is significant for the variable Self-esteem**.</span>
<span id="cb46-724"><a href="#cb46-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-725"><a href="#cb46-725" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model 3</span></span>
<span id="cb46-726"><a href="#cb46-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-727"><a href="#cb46-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, engine = 'tikz', echo = FALSE, fig.width=4, fig.height=2, fig.align='center'}</span></span>
<span id="cb46-728"><a href="#cb46-728" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric, arrows.meta, positioning}</span></span>
<span id="cb46-729"><a href="#cb46-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-730"><a href="#cb46-730" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{decision} = [diamond, draw, fill=white]</span></span>
<span id="cb46-731"><a href="#cb46-731" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{line} = [draw, -Stealth, thick]</span></span>
<span id="cb46-732"><a href="#cb46-732" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered]</span></span>
<span id="cb46-733"><a href="#cb46-733" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em]</span></span>
<span id="cb46-734"><a href="#cb46-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-735"><a href="#cb46-735" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb46-736"><a href="#cb46-736" aria-hidden="true" tabindex="-1"></a><span class="in">        % Create Blocks</span></span>
<span id="cb46-737"><a href="#cb46-737" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = green!30!white] (compS) {Social comparison};</span></span>
<span id="cb46-738"><a href="#cb46-738" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = magenta!30!white, below of = compS, yshift=0em, xshift=7em] (selfE) {Self esteem};</span></span>
<span id="cb46-739"><a href="#cb46-739" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = orange!30!white, below of = compS, yshift=0em, xshift=-7em] (spirit) {Spirituality};</span></span>
<span id="cb46-740"><a href="#cb46-740" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = cyan!30!white, below of = compS, yshift=-3em] (compT) {Temporal comparison};</span></span>
<span id="cb46-741"><a href="#cb46-741" aria-hidden="true" tabindex="-1"></a><span class="in">        % Add Arrows</span></span>
<span id="cb46-742"><a href="#cb46-742" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (compS);</span></span>
<span id="cb46-743"><a href="#cb46-743" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compS) -- (selfE);</span></span>
<span id="cb46-744"><a href="#cb46-744" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (selfE);</span></span>
<span id="cb46-745"><a href="#cb46-745" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (compT);</span></span>
<span id="cb46-746"><a href="#cb46-746" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compT) -- (selfE);</span></span>
<span id="cb46-747"><a href="#cb46-747" aria-hidden="true" tabindex="-1"></a><span class="in">    \end{tikzpicture}</span></span>
<span id="cb46-748"><a href="#cb46-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-749"><a href="#cb46-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-752"><a href="#cb46-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-753"><a href="#cb46-753" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb46-754"><a href="#cb46-754" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb46-755"><a href="#cb46-755" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc =~ compSoc1 + compSoc3 + compSoc4 + compSoc6</span></span>
<span id="cb46-756"><a href="#cb46-756" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp =~ compTemp1 + compTemp3 + compTemp4 + compTemp6</span></span>
<span id="cb46-757"><a href="#cb46-757" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb46-758"><a href="#cb46-758" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb46-759"><a href="#cb46-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-760"><a href="#cb46-760" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb46-761"><a href="#cb46-761" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc ~ 1 + c1 * Spirit</span></span>
<span id="cb46-762"><a href="#cb46-762" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp ~ 1 + b1 * Spirit</span></span>
<span id="cb46-763"><a href="#cb46-763" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompSoc + a3 * CompTemp</span></span>
<span id="cb46-764"><a href="#cb46-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-765"><a href="#cb46-765" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1</span></span>
<span id="cb46-766"><a href="#cb46-766" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect1 := (c1 * a2) </span></span>
<span id="cb46-767"><a href="#cb46-767" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect2 := (b1 * a3)</span></span>
<span id="cb46-768"><a href="#cb46-768" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := (c1 * a2) + (b1 * a3)</span></span>
<span id="cb46-769"><a href="#cb46-769" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb46-770"><a href="#cb46-770" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb46-771"><a href="#cb46-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-772"><a href="#cb46-772" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb46-773"><a href="#cb46-773" aria-hidden="true" tabindex="-1"></a>  model3,</span>
<span id="cb46-774"><a href="#cb46-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb46-775"><a href="#cb46-775" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb46-776"><a href="#cb46-776" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb46-777"><a href="#cb46-777" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span></span>
<span id="cb46-778"><a href="#cb46-778" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-779"><a href="#cb46-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-780"><a href="#cb46-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-781"><a href="#cb46-781" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;&lt;summary&gt;<span class="in">`summary(fit3)`</span>&lt;/summary&gt;</span>
<span id="cb46-782"><a href="#cb46-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='markup'}</span></span>
<span id="cb46-783"><a href="#cb46-783" aria-hidden="true" tabindex="-1"></a><span class="in">summary(fit3, fit = T, rsquare = T)</span></span>
<span id="cb46-784"><a href="#cb46-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-785"><a href="#cb46-785" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt; </span>
<span id="cb46-786"><a href="#cb46-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-787"><a href="#cb46-787" aria-hidden="true" tabindex="-1"></a>The aim is to analyse direct and indirect effects on **Self-esteem** for the model <span class="in">`fit3`</span>. To reference to the first part, we rename our latent variables as we already have done for <span class="in">`fit1`</span> and <span class="in">`fit2`</span> : </span>
<span id="cb46-788"><a href="#cb46-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-789"><a href="#cb46-789" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-790"><a href="#cb46-790" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-791"><a href="#cb46-791" aria-hidden="true" tabindex="-1"></a>X := \textsf{Spirituality} <span class="sc">\\</span></span>
<span id="cb46-792"><a href="#cb46-792" aria-hidden="true" tabindex="-1"></a>M_1 := \textsf{Social comparison} <span class="sc">\\</span></span>
<span id="cb46-793"><a href="#cb46-793" aria-hidden="true" tabindex="-1"></a>M_2 := \textsf{Temporal comparison} <span class="sc">\\</span></span>
<span id="cb46-794"><a href="#cb46-794" aria-hidden="true" tabindex="-1"></a>Y := \textsf{Self-esteem}</span>
<span id="cb46-795"><a href="#cb46-795" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-796"><a href="#cb46-796" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-797"><a href="#cb46-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-798"><a href="#cb46-798" aria-hidden="true" tabindex="-1"></a>This is a **parallel mediation model**. It is possible to analyse the direct and indirect effects on $Y$. Before that, we explicit the structural model and we substitute in the expression of $Y$.</span>
<span id="cb46-799"><a href="#cb46-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-800"><a href="#cb46-800" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-801"><a href="#cb46-801" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-802"><a href="#cb46-802" aria-hidden="true" tabindex="-1"></a>M_1 = c_0 + c_1X + \mathcal{E}_{M_1}<span class="sc">\\</span></span>
<span id="cb46-803"><a href="#cb46-803" aria-hidden="true" tabindex="-1"></a>M_2 = b_0 + b_1 X + \mathcal{E}_{M_2} <span class="sc">\\</span></span>
<span id="cb46-804"><a href="#cb46-804" aria-hidden="true" tabindex="-1"></a>Y = a_0 + a_1 X + a_2 M_1 + a_3M_2 + \mathcal{E}_Y</span>
<span id="cb46-805"><a href="#cb46-805" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-806"><a href="#cb46-806" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-807"><a href="#cb46-807" aria-hidden="true" tabindex="-1"></a>$$\Leftrightarrow Y = (a_0 + a_2c_0 + a_3b_0) + (a_1 + a_2c_1 + a_3b_1)X + \mathcal{E}'$$</span>
<span id="cb46-808"><a href="#cb46-808" aria-hidden="true" tabindex="-1"></a>We can verify that the model is identifiable by looking if the **degree of freedom is greater than 0** :</span>
<span id="cb46-811"><a href="#cb46-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-812"><a href="#cb46-812" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit3 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit3))</span>
<span id="cb46-813"><a href="#cb46-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-814"><a href="#cb46-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-815"><a href="#cb46-815" aria-hidden="true" tabindex="-1"></a>Finally, with the summary of the fit of the model <span class="in">`fit3`</span> in <span class="in">`R`</span>, we can build the following table:</span>
<span id="cb46-816"><a href="#cb46-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-817"><a href="#cb46-817" aria-hidden="true" tabindex="-1"></a>**Effect**      | **Expression**           | **Estimate** | **Std.Err** | **P-value** |</span>
<span id="cb46-818"><a href="#cb46-818" aria-hidden="true" tabindex="-1"></a> |--------------|--------------------------|--------------|-------------|-------------|</span>
<span id="cb46-819"><a href="#cb46-819" aria-hidden="true" tabindex="-1"></a> | Direct       | $a_1$                    | -0.036       | 0.062       | 0.561       |</span>
<span id="cb46-820"><a href="#cb46-820" aria-hidden="true" tabindex="-1"></a> | Indirect1    | $a_2 c_1$                | -0.116       | 0.047       | 0.013       |</span>
<span id="cb46-821"><a href="#cb46-821" aria-hidden="true" tabindex="-1"></a> | Indirect2    | $a_3 b_1$                |  0.023       | 0.019       | 0.235       |</span>
<span id="cb46-822"><a href="#cb46-822" aria-hidden="true" tabindex="-1"></a> | Indirect     | $a_2 c_1 + a_3 b_1$      | -0.093       | 0.038       | 0.014       |</span>
<span id="cb46-823"><a href="#cb46-823" aria-hidden="true" tabindex="-1"></a> | Total        | $a_1 + a_2 c_1 + a_3 b_1$| -0.129       | 0.061       | 0.034       |</span>
<span id="cb46-824"><a href="#cb46-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-825"><a href="#cb46-825" aria-hidden="true" tabindex="-1"></a>*Table ?????,: Effects on $Y$ for the model `fit3`*</span>
<span id="cb46-826"><a href="#cb46-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-827"><a href="#cb46-827" aria-hidden="true" tabindex="-1"></a>We can conclude that in the model <span class="in">`fit3`</span>, the **indirect effect is significant for the variable Self-esteem**.\</span>
<span id="cb46-828"><a href="#cb46-828" aria-hidden="true" tabindex="-1"></a>Especially, the most significant effect is given by the path :\</span>
<span id="cb46-829"><a href="#cb46-829" aria-hidden="true" tabindex="-1"></a>**Spirituality $\rightarrow$ Social comparison $\rightarrow$ Self-esteem**.</span>
<span id="cb46-830"><a href="#cb46-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-831"><a href="#cb46-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-832"><a href="#cb46-832" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model 4</span></span>
<span id="cb46-833"><a href="#cb46-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-834"><a href="#cb46-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, engine = 'tikz', echo = FALSE, fig.width=4, fig.height=2, fig.align='center'}</span></span>
<span id="cb46-835"><a href="#cb46-835" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric, arrows.meta, positioning}</span></span>
<span id="cb46-836"><a href="#cb46-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-837"><a href="#cb46-837" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{decision} = [diamond, draw, fill=white]</span></span>
<span id="cb46-838"><a href="#cb46-838" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{line} = [draw, -Stealth, thick]</span></span>
<span id="cb46-839"><a href="#cb46-839" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{elli} = [draw, ellipse, fill=gray!20, minimum height=8mm, text width=5em, text centered]</span></span>
<span id="cb46-840"><a href="#cb46-840" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{block} = [draw, rectangle, fill=white, text width=8em, text centered, minimum height=7mm, node distance=3em]</span></span>
<span id="cb46-841"><a href="#cb46-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-842"><a href="#cb46-842" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb46-843"><a href="#cb46-843" aria-hidden="true" tabindex="-1"></a><span class="in">        % Create Blocks</span></span>
<span id="cb46-844"><a href="#cb46-844" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = green!30!white] (compS) {Social comparison};</span></span>
<span id="cb46-845"><a href="#cb46-845" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = magenta!30!white, below of = compS, yshift=0em, xshift=7em] (selfE) {Self esteem};</span></span>
<span id="cb46-846"><a href="#cb46-846" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = orange!30!white, below of = compS, yshift=0em, xshift=-7em] (spirit) {Spirituality};</span></span>
<span id="cb46-847"><a href="#cb46-847" aria-hidden="true" tabindex="-1"></a><span class="in">        \node [elli, fill = cyan!30!white, below of = compS, yshift=-3em] (compT) {Temporal comparison};</span></span>
<span id="cb46-848"><a href="#cb46-848" aria-hidden="true" tabindex="-1"></a><span class="in">        % Add Arrows</span></span>
<span id="cb46-849"><a href="#cb46-849" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (compS);</span></span>
<span id="cb46-850"><a href="#cb46-850" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compS) -- (selfE);</span></span>
<span id="cb46-851"><a href="#cb46-851" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (selfE);</span></span>
<span id="cb46-852"><a href="#cb46-852" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (spirit) -- (compT);</span></span>
<span id="cb46-853"><a href="#cb46-853" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compT) -- (selfE);</span></span>
<span id="cb46-854"><a href="#cb46-854" aria-hidden="true" tabindex="-1"></a><span class="in">        \path [line] (compS) -- (compT);</span></span>
<span id="cb46-855"><a href="#cb46-855" aria-hidden="true" tabindex="-1"></a><span class="in">    \end{tikzpicture}</span></span>
<span id="cb46-856"><a href="#cb46-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-857"><a href="#cb46-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-860"><a href="#cb46-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-861"><a href="#cb46-861" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb46-862"><a href="#cb46-862" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb46-863"><a href="#cb46-863" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc =~ compSoc1 + compSoc3 + compSoc4 + compSoc6</span></span>
<span id="cb46-864"><a href="#cb46-864" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp =~ compTemp1 + compTemp3 + compTemp4 + compTemp6</span></span>
<span id="cb46-865"><a href="#cb46-865" aria-hidden="true" tabindex="-1"></a><span class="st">ES =~ es3 + es5 + es8 + es9 + es10</span></span>
<span id="cb46-866"><a href="#cb46-866" aria-hidden="true" tabindex="-1"></a><span class="st">Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16</span></span>
<span id="cb46-867"><a href="#cb46-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-868"><a href="#cb46-868" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb46-869"><a href="#cb46-869" aria-hidden="true" tabindex="-1"></a><span class="st">CompSoc ~ 1 + c1 * Spirit</span></span>
<span id="cb46-870"><a href="#cb46-870" aria-hidden="true" tabindex="-1"></a><span class="st">CompTemp ~ 1 + b1 * Spirit + b2 * CompSoc</span></span>
<span id="cb46-871"><a href="#cb46-871" aria-hidden="true" tabindex="-1"></a><span class="st">ES ~ 1 + a1 * Spirit + a2 * CompSoc + a3 * CompTemp</span></span>
<span id="cb46-872"><a href="#cb46-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-873"><a href="#cb46-873" aria-hidden="true" tabindex="-1"></a><span class="st">Direct := a1</span></span>
<span id="cb46-874"><a href="#cb46-874" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect1 := (c1 * a2) </span></span>
<span id="cb46-875"><a href="#cb46-875" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect2 := (b1 * a3)</span></span>
<span id="cb46-876"><a href="#cb46-876" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect3 := (c1 * b2 * a3)</span></span>
<span id="cb46-877"><a href="#cb46-877" aria-hidden="true" tabindex="-1"></a><span class="st">Indirect := (c1 * a2) + (b1 * a3) + (c1 * b2 * a3)</span></span>
<span id="cb46-878"><a href="#cb46-878" aria-hidden="true" tabindex="-1"></a><span class="st">Total := Direct + Indirect</span></span>
<span id="cb46-879"><a href="#cb46-879" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb46-880"><a href="#cb46-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-881"><a href="#cb46-881" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb46-882"><a href="#cb46-882" aria-hidden="true" tabindex="-1"></a>  model4,</span>
<span id="cb46-883"><a href="#cb46-883" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> SSPM_data,</span>
<span id="cb46-884"><a href="#cb46-884" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> T,</span>
<span id="cb46-885"><a href="#cb46-885" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"boot"</span>,</span>
<span id="cb46-886"><a href="#cb46-886" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">100</span></span>
<span id="cb46-887"><a href="#cb46-887" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-888"><a href="#cb46-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-889"><a href="#cb46-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-890"><a href="#cb46-890" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;&lt;summary&gt;<span class="in">`summary(fit4)`</span>&lt;/summary&gt;</span>
<span id="cb46-891"><a href="#cb46-891" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='markup'}</span></span>
<span id="cb46-892"><a href="#cb46-892" aria-hidden="true" tabindex="-1"></a><span class="in">summary(fit4, fit = T, rsquare = T)</span></span>
<span id="cb46-893"><a href="#cb46-893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-894"><a href="#cb46-894" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt; </span>
<span id="cb46-895"><a href="#cb46-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-896"><a href="#cb46-896" aria-hidden="true" tabindex="-1"></a>The aim is to analyse direct and indirect effects on **Self-esteem** for the model <span class="in">`fit4`</span>. To reference to the first part, we rename our latent variables as we already have done for <span class="in">`fit1`</span> and <span class="in">`fit2`</span> : </span>
<span id="cb46-897"><a href="#cb46-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-898"><a href="#cb46-898" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-899"><a href="#cb46-899" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-900"><a href="#cb46-900" aria-hidden="true" tabindex="-1"></a>X := \textsf{Spirituality} <span class="sc">\\</span></span>
<span id="cb46-901"><a href="#cb46-901" aria-hidden="true" tabindex="-1"></a>M_1 := \textsf{Social comparison} <span class="sc">\\</span></span>
<span id="cb46-902"><a href="#cb46-902" aria-hidden="true" tabindex="-1"></a>M_2 := \textsf{Temporal comparison} <span class="sc">\\</span></span>
<span id="cb46-903"><a href="#cb46-903" aria-hidden="true" tabindex="-1"></a>Y := \textsf{Self-esteem}</span>
<span id="cb46-904"><a href="#cb46-904" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-905"><a href="#cb46-905" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-906"><a href="#cb46-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-907"><a href="#cb46-907" aria-hidden="true" tabindex="-1"></a>This is a **serial mediation model**. It is possible to analyse the direct and indirect effects on $Y$. Before that, we explicit the structural model and we substitute in the expression of $Y$.</span>
<span id="cb46-908"><a href="#cb46-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-909"><a href="#cb46-909" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-910"><a href="#cb46-910" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb46-911"><a href="#cb46-911" aria-hidden="true" tabindex="-1"></a>M_1 = c_0 + c_1X + \mathcal{E}_{M_1}<span class="sc">\\</span></span>
<span id="cb46-912"><a href="#cb46-912" aria-hidden="true" tabindex="-1"></a>M_2 = b_0 + b_1 X + b_2 M_2 + \mathcal{E}_{M_2} <span class="sc">\\</span></span>
<span id="cb46-913"><a href="#cb46-913" aria-hidden="true" tabindex="-1"></a>Y = a_0 + a_1 X + a_2 M_1 + a_3M_2 + \mathcal{E}_Y</span>
<span id="cb46-914"><a href="#cb46-914" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb46-915"><a href="#cb46-915" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb46-916"><a href="#cb46-916" aria-hidden="true" tabindex="-1"></a>$$\Leftrightarrow Y = (a_0 + a_2c_0 + a_3b_0 + a_3b_2c_0) + (a_1 + a_2c_1 + a_3b_1 + a_3b_2c_1)X + \mathcal{E}'$$</span>
<span id="cb46-917"><a href="#cb46-917" aria-hidden="true" tabindex="-1"></a>We can verify that the model is identifiable by looking if the **degree of freedom is greater than 0** :</span>
<span id="cb46-920"><a href="#cb46-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-921"><a href="#cb46-921" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degree of fredom for fit4 :"</span>, semPower<span class="sc">::</span><span class="fu">semPower.getDf</span>(fit4))</span>
<span id="cb46-922"><a href="#cb46-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-923"><a href="#cb46-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-924"><a href="#cb46-924" aria-hidden="true" tabindex="-1"></a>Finally, with the summary of the fit of the model <span class="in">`fi43`</span> in <span class="in">`R`</span>, we can build the following table:</span>
<span id="cb46-925"><a href="#cb46-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-926"><a href="#cb46-926" aria-hidden="true" tabindex="-1"></a>**Effect**      | **Expression**                      | **Estimate** | **Std.Err** | **P-value** |</span>
<span id="cb46-927"><a href="#cb46-927" aria-hidden="true" tabindex="-1"></a> |--------------|-------------------------------------|--------------|-------------|-------------|</span>
<span id="cb46-928"><a href="#cb46-928" aria-hidden="true" tabindex="-1"></a> | Direct       | $a_1$                               | -0.033       | 0.063       | 0.604       |</span>
<span id="cb46-929"><a href="#cb46-929" aria-hidden="true" tabindex="-1"></a> | Indirect1    | $a_2 c_1$                           | -0.129       | 0.053       | 0.014       |</span>
<span id="cb46-930"><a href="#cb46-930" aria-hidden="true" tabindex="-1"></a> | Indirect2    | $a_3 b_1$                           | -0.002       | 0.013       | 0.880       |</span>
<span id="cb46-931"><a href="#cb46-931" aria-hidden="true" tabindex="-1"></a> | Indirect3    | $a_3b_2c_1$                         |  0.034       | 0.021       | 0.108       |</span>
<span id="cb46-932"><a href="#cb46-932" aria-hidden="true" tabindex="-1"></a> | Indirect     | $a_2 c_1 + a_3 b_1 + a_3b_2c_1$     | -0.097       | 0.039       | 0.014       |</span>
<span id="cb46-933"><a href="#cb46-933" aria-hidden="true" tabindex="-1"></a> | Total        | $a_1 + a_2c_1 + a_3b_1 + a_3b_2c_1$ | -0.130       | 0.061       | 0.034       |</span>
<span id="cb46-934"><a href="#cb46-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-935"><a href="#cb46-935" aria-hidden="true" tabindex="-1"></a>*Table ?????,: Effects on $Y$ for the model `fit4`*</span>
<span id="cb46-936"><a href="#cb46-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-937"><a href="#cb46-937" aria-hidden="true" tabindex="-1"></a>We can conclude that in the model <span class="in">`fit4`</span>, the **indirect effect is significant for the variable Self-esteem**.\</span>
<span id="cb46-938"><a href="#cb46-938" aria-hidden="true" tabindex="-1"></a>Especially, the most significant effect is given by the path :\</span>
<span id="cb46-939"><a href="#cb46-939" aria-hidden="true" tabindex="-1"></a>**Spirituality $\rightarrow$ Social comparison $\rightarrow$ Self-esteem** (same as <span class="in">`fit3`</span>).</span>
<span id="cb46-940"><a href="#cb46-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-941"><a href="#cb46-941" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-942"><a href="#cb46-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-943"><a href="#cb46-943" aria-hidden="true" tabindex="-1"></a><span class="fu">## Validation</span></span>
<span id="cb46-944"><a href="#cb46-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-945"><a href="#cb46-945" aria-hidden="true" tabindex="-1"></a>In this part, the objective will be to compare all the models we built to determine which one is the best for the study.</span>
<span id="cb46-946"><a href="#cb46-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-947"><a href="#cb46-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-948"><a href="#cb46-948" aria-hidden="true" tabindex="-1"></a><span class="fu">### Criteria AIC and BIC</span></span>
<span id="cb46-949"><a href="#cb46-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-950"><a href="#cb46-950" aria-hidden="true" tabindex="-1"></a>At first, the aim will be to compare models with the same size, that means \textit{mod1} with \textit{mod2} and \textit{mod3} with \textit{mod4}. To do that we use the criteria of AIC and BIC. All the values are given in the summaries of the different \textit{fit}.<span class="sc">\\</span>\vspace{0.2cm}</span>
<span id="cb46-951"><a href="#cb46-951" aria-hidden="true" tabindex="-1"></a>\begin{center}</span>
<span id="cb46-952"><a href="#cb46-952" aria-hidden="true" tabindex="-1"></a>    \begin{tabular}{|c||c|c|}\hline</span>
<span id="cb46-953"><a href="#cb46-953" aria-hidden="true" tabindex="-1"></a>        \textbf{Model} &amp; \textbf{AIC} &amp; \textbf{BIC} <span class="sc">\\</span> \hline \hline</span>
<span id="cb46-954"><a href="#cb46-954" aria-hidden="true" tabindex="-1"></a>        \textit{mod1} &amp; 18513.694 &amp; 18715.206 <span class="sc">\\</span> \hline</span>
<span id="cb46-955"><a href="#cb46-955" aria-hidden="true" tabindex="-1"></a>        \textit{mod2} &amp; 18355.843 &amp; 18557.356 <span class="sc">\\</span> \hline \hline</span>
<span id="cb46-956"><a href="#cb46-956" aria-hidden="true" tabindex="-1"></a>        \textit{mod3} &amp; 22390.464 &amp; 22629.997 <span class="sc">\\</span> \hline</span>
<span id="cb46-957"><a href="#cb46-957" aria-hidden="true" tabindex="-1"></a>        \textit{mod4} &amp; 22344.201 &amp; 22587.537 <span class="sc">\\</span> \hline</span>
<span id="cb46-958"><a href="#cb46-958" aria-hidden="true" tabindex="-1"></a>    \end{tabular}<span class="sc">\\</span></span>
<span id="cb46-959"><a href="#cb46-959" aria-hidden="true" tabindex="-1"></a>    \vspace{0.25cm}</span>
<span id="cb46-960"><a href="#cb46-960" aria-hidden="true" tabindex="-1"></a>    \texttt{Tabular 8 : Criteria AIC and BIC for the different models}<span class="sc">\\</span></span>
<span id="cb46-961"><a href="#cb46-961" aria-hidden="true" tabindex="-1"></a>\end{center}                         </span>
<span id="cb46-962"><a href="#cb46-962" aria-hidden="true" tabindex="-1"></a>\vspace{0.25cm}</span>
<span id="cb46-963"><a href="#cb46-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-964"><a href="#cb46-964" aria-hidden="true" tabindex="-1"></a>In both cases, the best model is the model which minimize the criterion AIC and the criterion BIC. We retain the models \textit{mod2} and \textit{mod4}.</span>
<span id="cb46-965"><a href="#cb46-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-966"><a href="#cb46-966" aria-hidden="true" tabindex="-1"></a><span class="fu">### Test of nested models</span></span>
<span id="cb46-967"><a href="#cb46-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-968"><a href="#cb46-968" aria-hidden="true" tabindex="-1"></a>Now stay available two models which are \textit{mod2} and \textit{mod4}. To decide between them, we realize a test of nested models using the function \texttt{anova} on \texttt{R}.<span class="sc">\\</span></span>
<span id="cb46-969"><a href="#cb46-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-970"><a href="#cb46-970" aria-hidden="true" tabindex="-1"></a>The Chi-Squared Difference Test give a p-value of 0,000104. <span class="sc">\\</span> The test indicates that it is preferable to keep the additional variable of the model \textit{mod4}.<span class="sc">\\</span></span>
<span id="cb46-971"><a href="#cb46-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-972"><a href="#cb46-972" aria-hidden="true" tabindex="-1"></a>We can conclude that the model \textit{mod4} is the best model for the study.</span>
<span id="cb46-973"><a href="#cb46-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-974"><a href="#cb46-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-975"><a href="#cb46-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-976"><a href="#cb46-976" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results</span></span>
<span id="cb46-977"><a href="#cb46-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-978"><a href="#cb46-978" aria-hidden="true" tabindex="-1"></a>The aim of the study was to understand the connections between spirituality, social comparison, temporal comparison and self-esteem for individuals. Especially, we wanted to analyze the effects of spirituality on self-esteem and determine if they pass through social comparison and/or temporal comparison. \</span>
<span id="cb46-979"><a href="#cb46-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-980"><a href="#cb46-980" aria-hidden="true" tabindex="-1"></a>Thanks to criteria and tests we used, we were able to define the best model for this study : \textit{mod4}.\</span>
<span id="cb46-981"><a href="#cb46-981" aria-hidden="true" tabindex="-1"></a>It gather all the notions and take into account an influence of social comparison on temporal comparison.</span>
<span id="cb46-982"><a href="#cb46-982" aria-hidden="true" tabindex="-1"></a>According to this model which highlights the significance of the indirect effect \textbf{Indirect1}, the main effect on self-esteem of individuals is social comparison due to spirituality.\</span>
<span id="cb46-983"><a href="#cb46-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-984"><a href="#cb46-984" aria-hidden="true" tabindex="-1"></a>To put it in a nutshell, we can conclude in favor of connection between the different notions. Especially, the effect of spirituality on self-esteem transits by social comparison.</span>
<span id="cb46-985"><a href="#cb46-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-986"><a href="#cb46-986" aria-hidden="true" tabindex="-1"></a><span class="fu">## Computational informations</span></span>
<span id="cb46-987"><a href="#cb46-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-988"><a href="#cb46-988" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;&lt;summary&gt;Session informations&lt;/summary&gt;</span>
<span id="cb46-989"><a href="#cb46-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session_info, results='markup'}</span></span>
<span id="cb46-990"><a href="#cb46-990" aria-hidden="true" tabindex="-1"></a><span class="in">devtools::session_info()</span></span>
<span id="cb46-991"><a href="#cb46-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-992"><a href="#cb46-992" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt; </span>
<span id="cb46-993"><a href="#cb46-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-994"><a href="#cb46-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-995"><a href="#cb46-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-996"><a href="#cb46-996" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb46-997"><a href="#cb46-997" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- model5 &lt;- ' --&gt;</span></span>
<span id="cb46-998"><a href="#cb46-998" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # MODELE DE MESURE --&gt;</span></span>
<span id="cb46-999"><a href="#cb46-999" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CompSoc =~ compSoc1 + compSoc2 + compSoc3 + compSoc4 + compSoc5 + compSoc6 + compSoc7 + compSoc8 --&gt;</span></span>
<span id="cb46-1000"><a href="#cb46-1000" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CompTemp =~ compTemp1 + compTemp2 + compTemp3 + compTemp4 + compTemp5 + compTemp6 + compTemp7 + compTemp8 --&gt;</span></span>
<span id="cb46-1001"><a href="#cb46-1001" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ES =~ es1 + es2 + es3 + es4 + es5 + es6 + es7 + es8 + es9 + es10 --&gt;</span></span>
<span id="cb46-1002"><a href="#cb46-1002" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Spirit =~ spirit1 + spirit2 + spirit3 + spirit4 + spirit5 + spirit6 + spirit7 + spirit8 + spirit9 + spirit10 + spirit11 + spirit12 + spirit13 + spirit14 + spirit15 + spirit16 --&gt;</span></span>
<span id="cb46-1003"><a href="#cb46-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1004"><a href="#cb46-1004" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Structural model --&gt;</span></span>
<span id="cb46-1005"><a href="#cb46-1005" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CompSoc ~ 1 + c1 * Spirit --&gt;</span></span>
<span id="cb46-1006"><a href="#cb46-1006" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- CompTemp ~ 1 + b1 * Spirit + b2 * CompSoc --&gt;</span></span>
<span id="cb46-1007"><a href="#cb46-1007" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ES ~ 1 + a1 * Spirit + a2 * CompSoc + a3 * CompTemp --&gt;</span></span>
<span id="cb46-1008"><a href="#cb46-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1009"><a href="#cb46-1009" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Direct := a1 --&gt;</span></span>
<span id="cb46-1010"><a href="#cb46-1010" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Indirect1 := (c1 * a2)  --&gt;</span></span>
<span id="cb46-1011"><a href="#cb46-1011" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Indirect2 := (b1 * a3) --&gt;</span></span>
<span id="cb46-1012"><a href="#cb46-1012" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Indirect3 := (c1 * b2 * a3) --&gt;</span></span>
<span id="cb46-1013"><a href="#cb46-1013" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Indirect := (c1 * a2) + (b1 * a3) + (c1 * b2 * a3) --&gt;</span></span>
<span id="cb46-1014"><a href="#cb46-1014" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Total := Direct + Indirect --&gt;</span></span>
<span id="cb46-1015"><a href="#cb46-1015" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ' --&gt;</span></span>
<span id="cb46-1016"><a href="#cb46-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1017"><a href="#cb46-1017" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- fit5 = sem( --&gt;</span></span>
<span id="cb46-1018"><a href="#cb46-1018" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   model5, --&gt;</span></span>
<span id="cb46-1019"><a href="#cb46-1019" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   data = SSPM_data, --&gt;</span></span>
<span id="cb46-1020"><a href="#cb46-1020" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   std.lv = T, --&gt;</span></span>
<span id="cb46-1021"><a href="#cb46-1021" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   se = "boot", --&gt;</span></span>
<span id="cb46-1022"><a href="#cb46-1022" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   bootstrap = 100 --&gt;</span></span>
<span id="cb46-1023"><a href="#cb46-1023" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ) --&gt;</span></span>
<span id="cb46-1024"><a href="#cb46-1024" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- summary(fit5, fit = T, rsquare = T) --&gt;</span></span>
<span id="cb46-1025"><a href="#cb46-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1026"><a href="#cb46-1026" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Clément Poupelin</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>